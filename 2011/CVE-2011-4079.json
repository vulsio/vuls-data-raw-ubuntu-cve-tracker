{
  "candidate": "CVE-2011-4079",
  "description": "Off-by-one error in the UTF8StringNormalize function in OpenLDAP 2.4.26 and earlier allows remote attackers to cause a denial of service (slapd crash) via a zero-length string that triggers a heap-based buffer overflow, as demonstrated using an empty postalAddressAttribute value in an LDIF entry.",
  "notes": {
    "jdstrand": "patch requires http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=patch;h=d0dd8616f1c68a868afeb8c2c5c09969e366e2c0 while bug exists since 2003, postalAddressValidate() is only function that could pass a 0-length string, and this is not present in 8.04 LTS. while RedHat claims heap implementation makes this not exploitable, will patch Ubuntu 10.04 and higher just in case the evaluation is incorrect.",
    "tyhicks": "Per Red Hat, this may not be exploitable due to properties of the memory allocator."
  },
  "priority": "medium",
  "bugs": [
    "http://www.openldap.org/its/index.cgi/Software%20Bugs?id=7059;selectid=7059",
    "https://bugzilla.redhat.com/show_bug.cgi?id=749324",
    "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=647610",
    "https://launchpad.net/bugs/884163",
    "https://bugzilla.novell.com/show_bug.cgi?id=724201"
  ],
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4079",
    "https://ubuntu.com/security/notices/USN-1266-1"
  ],
  "assigned_to": "jdstrand",
  "public_date": "2011-10-27 20:55:00 UTC",
  "public_date_at_usn": "2011-10-27",
  "packages": {
    "devel": {
      "openldap": {
        "name": "openldap",
        "status": "released",
        "note": "2.4.25-3ubuntu2",
        "patches": [
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commitdiff;h=507238713b71208ec4f262f312cb495a302df9e9 (trunk)"
          },
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commit;h=e75c8720191c12db55ab2342fc8f560011c591b8 (2.4)"
          }
        ]
      },
      "openldap2.3": {
        "name": "openldap2.3",
        "status": "DNE"
      }
    },
    "hardy": {
      "openldap": {
        "name": "openldap",
        "status": "DNE",
        "patches": [
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commitdiff;h=507238713b71208ec4f262f312cb495a302df9e9 (trunk)"
          },
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commit;h=e75c8720191c12db55ab2342fc8f560011c591b8 (2.4)"
          }
        ]
      },
      "openldap2.3": {
        "name": "openldap2.3",
        "status": "not-affected",
        "note": "vulnerable code not present"
      }
    },
    "lucid": {
      "openldap": {
        "name": "openldap",
        "status": "released",
        "note": "2.4.21-0ubuntu5.6",
        "patches": [
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commitdiff;h=507238713b71208ec4f262f312cb495a302df9e9 (trunk)"
          },
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commit;h=e75c8720191c12db55ab2342fc8f560011c591b8 (2.4)"
          }
        ]
      },
      "openldap2.3": {
        "name": "openldap2.3",
        "status": "DNE"
      }
    },
    "maverick": {
      "openldap": {
        "name": "openldap",
        "status": "released",
        "note": "2.4.23-0ubuntu3.7",
        "patches": [
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commitdiff;h=507238713b71208ec4f262f312cb495a302df9e9 (trunk)"
          },
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commit;h=e75c8720191c12db55ab2342fc8f560011c591b8 (2.4)"
          }
        ]
      },
      "openldap2.3": {
        "name": "openldap2.3",
        "status": "DNE"
      }
    },
    "natty": {
      "openldap": {
        "name": "openldap",
        "status": "released",
        "note": "2.4.23-6ubuntu6.1",
        "patches": [
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commitdiff;h=507238713b71208ec4f262f312cb495a302df9e9 (trunk)"
          },
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commit;h=e75c8720191c12db55ab2342fc8f560011c591b8 (2.4)"
          }
        ]
      },
      "openldap2.3": {
        "name": "openldap2.3",
        "status": "DNE"
      }
    },
    "oneiric": {
      "openldap": {
        "name": "openldap",
        "status": "released",
        "note": "2.4.25-1.1ubuntu4.1",
        "patches": [
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commitdiff;h=507238713b71208ec4f262f312cb495a302df9e9 (trunk)"
          },
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commit;h=e75c8720191c12db55ab2342fc8f560011c591b8 (2.4)"
          }
        ]
      },
      "openldap2.3": {
        "name": "openldap2.3",
        "status": "DNE"
      }
    },
    "upstream": {
      "openldap": {
        "name": "openldap",
        "status": "needed",
        "patches": [
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commitdiff;h=507238713b71208ec4f262f312cb495a302df9e9 (trunk)"
          },
          {
            "source": "upstream",
            "text": "http://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commit;h=e75c8720191c12db55ab2342fc8f560011c591b8 (2.4)"
          }
        ]
      },
      "openldap2.3": {
        "name": "openldap2.3",
        "status": "needed"
      }
    }
  }
}
