{
	"candidate": "CVE-2023-40551",
	"description": "",
	"ubuntu_description": "[pe-relocate: Fix bounds check for MZ binaries In read_header(), we attempt to parse the PE binary headers.  In doing so, if there is an MZ (i.e. MS-DOS) header, we locate the PE header by finding the offset in that header.  Unfortunately that is not correctly bounds checked, and carefully chosen values can cause an out-of-bounds ready beyond the end of the loaded binary. Unfortunately the trivial fix (bounds check that value) also makes it clear that the way we were determining if an image is loadable on this platform and distinguishing between PE32 and PE32+ binaries has the exact same issue going on, and so the fix includes reworking that logic to correctly bounds check all of those tests as well. It's not currently known if this is actually exploitable beyond creating a denial of service, and an attacker who is in a position to use it for a denial of service attack must already be able to do so.]",
	"notes": {
		"eslerm": "secureboot-db should only ever be updated after shim secureboot-db is not updated on ESM releases as doing so would revoke install media keys Note that key revocation is required to protect against evil housekeeper attacks (such as BlackLotus)"
	},
	"priority": "medium",
	"references": [
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-40551"
	],
	"discovered_by": "Greg Kirkpatrick",
	"public_date": "2024-01-23",
	"crd": "2024-01-23",
	"packages": {
		"bionic": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of standard support"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"devel": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"esm-infra/bionic": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"esm-infra/xenial": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "install media keys will never be revoked",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "install media keys will never be revoked"
			}
		},
		"focal": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"jammy": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"lunar": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"mantic": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"trusty": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of standard support"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"trusty/esm": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "install media keys will never be revoked",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "install media keys will never be revoked"
			}
		},
		"upstream": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"xenial": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of standard support"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/5a5147d1e19cf90ec280990c84061ac3f67ea1ab"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of standard support"
			}
		}
	}
}
