{
	"candidate": "CVE-2023-29491",
	"description": "ncurses before 6.4 20230408, when used by a setuid application, allows local users to trigger security-relevant memory corruption via malformed data in a terminfo database file that is found in $HOME/.terminfo or reached via the TERMINFO or TERM environment variable.",
	"notes": {
		"ccdm94": "applying the upstream patch of ncurses that fixes this issue to focal and earlier would have been too intrusive, since changes such as the various made by commit 790a85db were not present in their versions of this package. Setting the --disable-root-environ option with a few additional changes to the code (as done by Debian in version 6.4-3 of the package) allows us to mitigate this issue and avoid other issues that involve the possibility of malicious use of environment variables through setuid applications, and, therefore, it was the fix chosen in order to resolve this vulnerability.",
		"mdeslaur": "TODO: investigate why ncurses is built without \"with_root_environ=no\" build option, that should be the default going forward to prevent these types of issues.",
		"rodrigo-zaiden": "upstream commit has miscellaneous changes besides the security fix."
	},
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]"
	},
	"bugs": [
		"http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1034372"
	],
	"references": [
		"https://invisible-island.net/ncurses/NEWS.html#index-t20230408",
		"https://www.openwall.com/lists/oss-security/2023/04/13/4",
		"https://www.openwall.com/lists/oss-security/2023/04/12/5",
		"https://ubuntu.com/security/notices/USN-6099-1",
		"https://www.cve.org/CVERecord?id=CVE-2023-29491"
	],
	"public_date": "2023-04-14 01:15:00 UTC",
	"public_date_at_usn": "2023-04-14 01:15:00 UTC",
	"packages": {
		"bionic": {
			"ncurses": {
				"name": "ncurses",
				"status": "released",
				"note": "6.1-1ubuntu1.18.04.1",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		},
		"devel": {
			"ncurses": {
				"name": "ncurses",
				"status": "not-affected",
				"note": "6.4-4",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		},
		"esm-infra-legacy/trusty": {
			"ncurses": {
				"name": "ncurses",
				"status": "not-affected",
				"note": "5.9+20140118-1ubuntu1+esm3",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		},
		"esm-infra/bionic": {
			"ncurses": {
				"name": "ncurses",
				"status": "not-affected",
				"note": "6.1-1ubuntu1.18.04.1",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		},
		"esm-infra/xenial": {
			"ncurses": {
				"name": "ncurses",
				"status": "released",
				"note": "6.0+20160213-1ubuntu1+esm3",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		},
		"focal": {
			"ncurses": {
				"name": "ncurses",
				"status": "released",
				"note": "6.2-0ubuntu2.1",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		},
		"jammy": {
			"ncurses": {
				"name": "ncurses",
				"status": "released",
				"note": "6.3-2ubuntu0.1",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		},
		"kinetic": {
			"ncurses": {
				"name": "ncurses",
				"status": "released",
				"note": "6.3+20220423-2ubuntu0.1",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		},
		"lunar": {
			"ncurses": {
				"name": "ncurses",
				"status": "released",
				"note": "6.4-2ubuntu0.1",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		},
		"trusty": {
			"ncurses": {
				"name": "ncurses",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		},
		"trusty/esm": {
			"ncurses": {
				"name": "ncurses",
				"status": "released",
				"note": "5.9+20140118-1ubuntu1+esm3",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		},
		"upstream": {
			"ncurses": {
				"name": "ncurses",
				"status": "released",
				"note": "6.4-3, 6.4+20230408",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		},
		"xenial": {
			"ncurses": {
				"name": "ncurses",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=eb51b1ea1f75a0ec17c9c5937cb28df1e8eeec56"
					}
				]
			}
		}
	}
}
