{
	"candidate": "CVE-2023-30571",
	"description": "Libarchive through 3.6.2 can cause directories to have world-writable permissions. The umask() call inside archive_write_disk_posix.c changes the umask of the whole process for a very short period of time; a race condition with another thread can lead to a permanent umask 0 setting. Such a race condition could lead to implicit directory creation with permissions 0777 (without the sticky bit), which means that any low-privileged local user can delete and rename files inside those directories.",
	"notes": {
		"mdeslaur": "Upstream fix is just a documentation change to specify that users of libarchive need to use a mutex. We will not be releasing a security update to change the documentation. Marking this CVE as ignored for all releases."
	},
	"priority": "negligible",
	"cvss": {
		"nvd": " CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:H [5.3 MEDIUM]"
	},
	"bugs": [
		"https://github.com/libarchive/libarchive/issues/1876"
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2023-30571"
	],
	"public_date": "2023-05-29 20:15:00 UTC",
	"packages": {
		"bionic": {
			"libarchive": {
				"name": "libarchive",
				"status": "ignored",
				"note": "end of standard support, was needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/pull/1875"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac"
					}
				]
			}
		},
		"devel": {
			"libarchive": {
				"name": "libarchive",
				"status": "ignored",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/pull/1875"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac"
					}
				]
			}
		},
		"esm-infra/bionic": {
			"libarchive": {
				"name": "libarchive",
				"status": "ignored",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/pull/1875"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac"
					}
				]
			}
		},
		"esm-infra/xenial": {
			"libarchive": {
				"name": "libarchive",
				"status": "ignored",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/pull/1875"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac"
					}
				]
			}
		},
		"focal": {
			"libarchive": {
				"name": "libarchive",
				"status": "ignored",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/pull/1875"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac"
					}
				]
			}
		},
		"jammy": {
			"libarchive": {
				"name": "libarchive",
				"status": "ignored",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/pull/1875"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac"
					}
				]
			}
		},
		"kinetic": {
			"libarchive": {
				"name": "libarchive",
				"status": "ignored",
				"note": "end of life, was deferred [2023-07-10]",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/pull/1875"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac"
					}
				]
			}
		},
		"lunar": {
			"libarchive": {
				"name": "libarchive",
				"status": "ignored",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/pull/1875"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac"
					}
				]
			}
		},
		"trusty": {
			"libarchive": {
				"name": "libarchive",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/pull/1875"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac"
					}
				]
			}
		},
		"trusty/esm": {
			"libarchive": {
				"name": "libarchive",
				"status": "ignored",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/pull/1875"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac"
					}
				]
			}
		},
		"upstream": {
			"libarchive": {
				"name": "libarchive",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/pull/1875"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac"
					}
				]
			}
		},
		"xenial": {
			"libarchive": {
				"name": "libarchive",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/pull/1875"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libarchive/libarchive/commit/27bad820790aacdff32dcbd09eeca69037d7c0ac"
					}
				]
			}
		}
	}
}
