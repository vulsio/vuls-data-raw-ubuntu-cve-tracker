{
	"candidate": "CVE-2023-45866",
	"description": "Bluetooth HID Hosts in BlueZ may permit an unauthenticated Peripheral role HID Device to initiate and establish an encrypted connection, and accept HID keyboard reports, potentially permitting injection of HID messages when no user interaction has occurred in the Central role to authorize such access. An example affected package is bluez 5.64-0ubuntu1 in Ubuntu 22.04LTS. NOTE: in some cases, a CVE-2020-0556 mitigation would have already addressed this Bluetooth HID Hosts issue.",
	"ubuntu_description": "It was discovered that BlueZ did not properly restrict non-bonded devices from injecting HID events into the input subsystem. This could allow a physically proximate attacker to inject keystrokes and execute arbitrary commands whilst the device is discoverable.",
	"notes": {
		"eslerm": "underlying issue was addressed in CVE-2020-0556, but was not enabled and not compliant with Security Mode 4 patch released ahead of public CRD"
	},
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L [6.3 MEDIUM]"
	},
	"mitigation": " In `/etc/bluetooth/input.conf` set `ClassicBondedOnly=true` and\n then `systemctl restart bluetooth`.\n Setting `ClassicBondedOnly=false` will re-enable legacy device\n support (like the PS3 controller) and the vulnerability.",
	"references": [
		"https://github.com/skysafe/reblog/tree/main/cve-2023-45866",
		"https://ubuntu.com/security/notices/USN-6540-1",
		"https://www.cve.org/CVERecord?id=CVE-2023-45866"
	],
	"assigned_to": "0xnishit",
	"discovered_by": "Marc Newlin",
	"public_date": "2023-12-08 06:15:00 UTC",
	"public_date_at_usn": "2023-12-06",
	"crd": "2023-12-06",
	"packages": {
		"bionic": {
			"bluez": {
				"name": "bluez",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675"
					}
				]
			}
		},
		"devel": {
			"bluez": {
				"name": "bluez",
				"status": "pending",
				"note": "5.70-0ubuntu3",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675"
					}
				]
			}
		},
		"esm-infra/bionic": {
			"bluez": {
				"name": "bluez",
				"status": "released",
				"note": "5.48-0ubuntu3.9+esm1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675"
					}
				]
			}
		},
		"esm-infra/xenial": {
			"bluez": {
				"name": "bluez",
				"status": "released",
				"note": "5.37-0ubuntu5.3+esm3",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675"
					}
				]
			}
		},
		"focal": {
			"bluez": {
				"name": "bluez",
				"status": "released",
				"note": "5.53-0ubuntu3.7",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675"
					}
				]
			}
		},
		"jammy": {
			"bluez": {
				"name": "bluez",
				"status": "released",
				"note": "5.64-0ubuntu1.1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675"
					}
				]
			}
		},
		"lunar": {
			"bluez": {
				"name": "bluez",
				"status": "released",
				"note": "5.66-0ubuntu1.1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675"
					}
				]
			}
		},
		"mantic": {
			"bluez": {
				"name": "bluez",
				"status": "released",
				"note": "5.68-0ubuntu1.1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675"
					}
				]
			}
		},
		"trusty": {
			"bluez": {
				"name": "bluez",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675"
					}
				]
			}
		},
		"upstream": {
			"bluez": {
				"name": "bluez",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675"
					}
				]
			}
		},
		"xenial": {
			"bluez": {
				"name": "bluez",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/profiles/input?id=25a471a83e02e1effb15d5a488b3f0085eaeb675"
					}
				]
			}
		}
	}
}
