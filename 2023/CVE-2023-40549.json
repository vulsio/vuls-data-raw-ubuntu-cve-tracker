{
	"candidate": "CVE-2023-40549",
	"description": "[Authenticode: verify that the signature header is in bounds. In the validation logic in verify_buffer_authenticode(), there is yet another case where we need to guarantee an object is in the binary but we're only validating the pointer to it.  In this case, we're validating that the actual signature data is in the binary, but unfortunately we failed to validate that the header describing it is, so a malformed binary can cause us to take an out-of-bounds read (probably but not necessarily on the same page) past the end of the buffer. This patch adds a bounds check to verify that the signature is actually within the bounds. It seems unlikely this can be used for more than a denial of service, and if you can get shim to try to verify a malformed binary, you've effectively already accomplished a DoS.]",
	"notes": {
		"eslerm": "secureboot-db should only ever be updated after shim secureboot-db is not updated on ESM releases as doing so would revoke install media keys Note that key revocation is required to protect against evil housekeeper attacks (such as BlackLotus)"
	},
	"priority": "medium",
	"references": [
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-40549"
	],
	"discovered_by": "Greg Kirkpatrick",
	"public_date": "2024-01-23",
	"crd": "2024-01-23",
	"packages": {
		"bionic": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of standard support"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/afdc5039de0a4a3a40162a32daa070f94a883f09"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"devel": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/afdc5039de0a4a3a40162a32daa070f94a883f09"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"esm-infra/bionic": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/afdc5039de0a4a3a40162a32daa070f94a883f09"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"esm-infra/xenial": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "install media keys will never be revoked",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/afdc5039de0a4a3a40162a32daa070f94a883f09"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "install media keys will never be revoked"
			}
		},
		"focal": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/afdc5039de0a4a3a40162a32daa070f94a883f09"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"jammy": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/afdc5039de0a4a3a40162a32daa070f94a883f09"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"lunar": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/afdc5039de0a4a3a40162a32daa070f94a883f09"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"mantic": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/afdc5039de0a4a3a40162a32daa070f94a883f09"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"trusty": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of standard support"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/afdc5039de0a4a3a40162a32daa070f94a883f09"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"trusty/esm": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "install media keys will never be revoked",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/afdc5039de0a4a3a40162a32daa070f94a883f09"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "install media keys will never be revoked"
			}
		},
		"upstream": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/afdc5039de0a4a3a40162a32daa070f94a883f09"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"xenial": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of standard support"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/afdc5039de0a4a3a40162a32daa070f94a883f09"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of standard support"
			}
		}
	}
}
