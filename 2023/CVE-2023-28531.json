{
  "candidate": "CVE-2023-28531",
  "description": "ssh-add in OpenSSH before 9.3 adds smartcard keys to ssh-agent without the intended per-hop destination constraints. The earliest affected version is 8.9.",
  "notes": {
    "sbeattie": "introduced in openssh 8.9",
    "seth-arnold": "openssh-ssh1 is provided for compatibility with old devices that cannot be upgraded to modern protocols. Thus we may not provide security support for this package if doing so would prevent access to equipment."
  },
  "priority": "low",
  "cvss": {
    "nvd": " CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]"
  },
  "bugs": [
    "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1033166",
    "Only affects configurations using agent forwarding, smartcard keys, and",
    "per-hop destination constraints. Policy bypass only."
  ],
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-28531",
    "https://www.openwall.com/lists/oss-security/2023/03/15/8"
  ],
  "discovered_by": "Luci Stanescu",
  "public_date": "2023-03-17 04:15:00 UTC",
  "packages": {
    "bionic": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      },
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "not-affected",
        "note": "only affects 8.9 and newer"
      }
    },
    "devel": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "1:9.3p1-1ubuntu1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      },
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "not-affected",
        "note": "only affects 8.9 and newer"
      }
    },
    "esm-apps/bionic": {
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "not-affected",
        "note": "only affects 8.9 and newer"
      }
    },
    "esm-apps/focal": {
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "not-affected",
        "note": "only affects 8.9 and newer"
      }
    },
    "esm-apps/jammy": {
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "not-affected",
        "note": "only affects 8.9 and newer"
      }
    },
    "esm-infra/bionic": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      }
    },
    "esm-infra/xenial": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      }
    },
    "fips-updates/bionic": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      }
    },
    "fips-updates/focal": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      }
    },
    "fips-updates/xenial": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      }
    },
    "fips/bionic": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      }
    },
    "fips/focal": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      }
    },
    "fips/xenial": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      }
    },
    "focal": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      },
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "not-affected",
        "note": "only affects 8.9 and newer"
      }
    },
    "jammy": {
      "openssh": {
        "name": "openssh",
        "status": "needed",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      },
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "not-affected",
        "note": "only affects 8.9 and newer"
      }
    },
    "kinetic": {
      "openssh": {
        "name": "openssh",
        "status": "ignored",
        "note": "end of life",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      },
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "not-affected",
        "note": "only affects 8.9 and newer"
      }
    },
    "lunar": {
      "openssh": {
        "name": "openssh",
        "status": "needed",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      },
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "not-affected",
        "note": "only affects 8.9 and newer"
      }
    },
    "mantic": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "1:9.3p1-1ubuntu1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      },
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "not-affected",
        "note": "only affects 8.9 and newer"
      }
    },
    "trusty": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      },
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "DNE"
      }
    },
    "trusty/esm": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      }
    },
    "upstream": {
      "openssh": {
        "name": "openssh",
        "status": "released",
        "note": "9.3",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      },
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "ignored",
        "note": "frozen on openssh 7.5p"
      }
    },
    "xenial": {
      "openssh": {
        "name": "openssh",
        "status": "not-affected",
        "note": "only affects 8.9 and newer",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openssh/openssh-portable/commit/54ac4ab2b53ce9fcb66b8250dee91c070e4167ed"
          }
        ]
      },
      "openssh-ssh1": {
        "name": "openssh-ssh1",
        "status": "DNE"
      }
    }
  }
}
