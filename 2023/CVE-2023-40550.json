{
	"candidate": "CVE-2023-40550",
	"description": "An out-of-bounds read flaw was found in Shim when it tried to validate the SBAT information. This issue may expose sensitive data during the system's boot phase.",
	"ubuntu_description": "[Fix an out-of-bound read in verify_buffer_sbat() In verify_buffer_sbat(), we have a goal-seeking loop to find the .sbat section header.  Unfortunately, while the actual contents of the section are checked for being inside the binary, no such check exists for the contents of the section table entry. As a result, a carefully constructed binary will cause an out-of-bounds read checking if the section name is \".sbat\\0\\0\\0\" or not. This patch adds a check that each section table entry is within the bounds of the binary. It's not currently known if this is actually exploitable beyond creating a denial of service, and an attacker who is in a position to use it for a denial of service attack must already be able to do so.]",
	"notes": {
		"eslerm": "UEFI Security Response Team states that dbx update is not needed secureboot-db should only ever be updated after shim secureboot-db is not updated on ESM releases as doing so would revoke install media keys Note that key revocation is required to protect against evil housekeeper attacks (such as BlackLotus) see also e7f5fdf (\"pe-relocate: Ensure nothing else implements CVE-2023-40550\")"
	},
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N [5.5 MEDIUM]"
	},
	"bugs": [
		"https://bugs.launchpad.net/ubuntu/+source/shim/+bug/2051151"
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2023-40550"
	],
	"discovered_by": "Greg Kirkpatrick",
	"public_date": "2024-01-29 17:15:00 UTC",
	"crd": "2024-01-23",
	"packages": {
		"bionic": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of standard support"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"devel": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "not-affected",
				"note": "sbat only update"
			},
			"shim": {
				"name": "shim",
				"status": "released",
				"note": "15.8-0ubuntu1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "released",
				"note": "15.8"
			}
		},
		"esm-infra-legacy/trusty": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "not-affected",
				"note": "sbat only update"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "install media keys will never be revoked",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "install media keys will never be revoked"
			}
		},
		"esm-infra/bionic": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "not-affected",
				"note": "sbat only update"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"esm-infra/xenial": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "not-affected",
				"note": "sbat only update"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "install media keys will never be revoked",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "install media keys will never be revoked"
			}
		},
		"focal": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "not-affected",
				"note": "sbat only update"
			},
			"shim": {
				"name": "shim",
				"status": "needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needed"
			}
		},
		"jammy": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "not-affected",
				"note": "sbat only update"
			},
			"shim": {
				"name": "shim",
				"status": "needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needed"
			}
		},
		"lunar": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of life, was needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of life, was needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of life, was needs-triage"
			}
		},
		"mantic": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "not-affected",
				"note": "sbat only update"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of life, was needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of life, was needed"
			}
		},
		"noble": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "not-affected",
				"note": "sbat only update"
			},
			"shim": {
				"name": "shim",
				"status": "released",
				"note": "15.8-0ubuntu1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "released",
				"note": "15.8"
			}
		},
		"trusty": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of standard support"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"trusty/esm": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "not-affected",
				"note": "sbat only update"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "install media keys will never be revoked",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "install media keys will never be revoked"
			}
		},
		"upstream": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "not-affected",
				"note": "sbat only update"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"xenial": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of standard support"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/93ce2552f3e9f71f888a672913bfc0eef255c56d (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of standard support"
			}
		}
	}
}
