{
	"candidate": "CVE-2023-26604",
	"description": "systemd before 247 does not adequately block local privilege escalation for some Sudo configurations, e.g., plausible sudoers files in which the \"systemctl status\" command may be executed. Specifically, systemd does not set LESSSECURE to 1, and thus other programs may be launched from the less program. This presents a substantial security risk when running systemctl from Sudo, because less executes as root when the terminal size is too small to show the complete systemctl output.",
	"notes": {
		"mdeslaur": "This is only an issue if an administrator configured systemctl access using sudo instead of using policykit, which is an unlikely scenario. Per Red Hat bug, systemctl commands that use the pager can run unprivileged. Setting priority to \"low\".",
		"rodrigo-zaiden": "on https://github.com/systemd/systemd/issues/5666 upstream claims this is not a vulnerability. upstream feature SYSTEMD_PAGERSECURE implemented in systemd version 247."
	},
	"priority": "low",
	"cvss": {
		"nvd": " CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]"
	},
	"bugs": [
		"https://github.com/systemd/systemd/issues/5666",
		"https://bugzilla.redhat.com/show_bug.cgi?id=2175611"
	],
	"references": [
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-26604",
		"https://medium.com/@zenmoviefornotification/saidov-maxim-cve-2023-26604-c1232a526ba7",
		"https://github.com/systemd/systemd/blob/main/NEWS#L4335-L4340",
		"https://blog.compass-security.com/2012/10/dangerous-sudoers-entries-part-2-insecure-functionality/"
	],
	"discovered_by": "Steve Hay",
	"public_date": "2023-03-03 16:15:00 UTC",
	"packages": {
		"bionic": {
			"systemd": {
				"name": "systemd",
				"status": "ignored",
				"note": "end of standard support, was needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		},
		"devel": {
			"systemd": {
				"name": "systemd",
				"status": "not-affected",
				"note": "252.4-1ubuntu1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		},
		"esm-infra/bionic": {
			"systemd": {
				"name": "systemd",
				"status": "needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		},
		"esm-infra/xenial": {
			"systemd": {
				"name": "systemd",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		},
		"focal": {
			"systemd": {
				"name": "systemd",
				"status": "needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		},
		"jammy": {
			"systemd": {
				"name": "systemd",
				"status": "not-affected",
				"note": "249.11-0ubuntu3.6",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		},
		"kinetic": {
			"systemd": {
				"name": "systemd",
				"status": "not-affected",
				"note": "251.4-1ubuntu7",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		},
		"lunar": {
			"systemd": {
				"name": "systemd",
				"status": "not-affected",
				"note": "252.4-1ubuntu1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		},
		"mantic": {
			"systemd": {
				"name": "systemd",
				"status": "not-affected",
				"note": "252.4-1ubuntu1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		},
		"trusty": {
			"systemd": {
				"name": "systemd",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		},
		"trusty/esm": {
			"systemd": {
				"name": "systemd",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		},
		"upstream": {
			"systemd": {
				"name": "systemd",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		},
		"xenial": {
			"systemd": {
				"name": "systemd",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/612ebf6c913dd0e4197c44909cb3157f5c51a2f0"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/0a42426d797406b4b01a0d9c13bb759c2629d108"
					},
					{
						"source": "upstream",
						"text": "https://github.com/systemd/systemd/commit/b8f736b30e20a2b44e7c34bb4e43b0d97ae77e3c"
					}
				]
			}
		}
	}
}
