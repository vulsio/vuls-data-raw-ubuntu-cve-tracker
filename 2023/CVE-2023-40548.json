{
	"candidate": "CVE-2023-40548",
	"description": "[Fix integer overflow on SBAT section size on 32-bit system In verify_sbat_section(), we do some math on data that comes from the binary being verified - in this case, we add 1 to the size of the \".sbat\" section as reported in the section header, which is then used as the input to the size of an allocation.  The original value is then used for a size in a memcpy(), which means there's an out-of-bounds write in the overflow case. Due to the type of the variable being size_t, but the type in the section header being uint32_t, this is only plausibly accomplished on 32-bit systems. This patch makes the arithmetic use a checked add operation to avoid overflow.  Additionally, it adds a check in verify_buffer_sbat() to guarantee that the data is within the binary. It's not currently known if this is actually exploitable on such systems; the memory layout on a particular machine may further mitigate this scenario.]",
	"notes": {
		"eslerm": "secureboot-db should only ever be updated after shim secureboot-db is not updated on ESM releases as doing so would revoke install media keys Note that key revocation is required to protect against evil housekeeper attacks (such as BlackLotus)"
	},
	"priority": "medium",
	"references": [
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-40548"
	],
	"discovered_by": "Greg Kirkpatrick",
	"public_date": "2024-01-23",
	"crd": "2024-01-23",
	"packages": {
		"bionic": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of standard support"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"devel": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"esm-infra/bionic": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"esm-infra/xenial": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "install media keys will never be revoked",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "install media keys will never be revoked"
			}
		},
		"focal": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"jammy": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"lunar": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of life, was needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of life, was needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of life, was needs-triage"
			}
		},
		"mantic": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"trusty": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of standard support"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"trusty/esm": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "install media keys will never be revoked",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "install media keys will never be revoked"
			}
		},
		"upstream": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "needs-triage"
			},
			"shim": {
				"name": "shim",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "needs-triage"
			}
		},
		"xenial": {
			"secureboot-db": {
				"name": "secureboot-db",
				"status": "ignored",
				"note": "end of standard support"
			},
			"shim": {
				"name": "shim",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/rhboot/shim/commit/96dccc255b16e9465dbee50b3cef6b3db74d11c8 (15.8)"
					}
				]
			},
			"shim-signed": {
				"name": "shim-signed",
				"status": "ignored",
				"note": "end of standard support"
			}
		}
	}
}
