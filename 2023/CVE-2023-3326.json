{
	"candidate": "CVE-2023-3326",
	"description": "pam_krb5 authenticates a user by essentially running kinit with the password, getting a ticket-granting ticket (tgt) from the Kerberos KDC (Key Distribution Center) over the network, as a way to verify the password. However, if a keytab is not provisioned on the system, pam_krb5 has no way to validate the response from the KDC, and essentially trusts the tgt provided over the network as being valid. In a non-default FreeBSD installation that leverages pam_krb5 for authentication and does not have a keytab provisioned, an attacker that is able to control both the password and the KDC responses can return a valid tgt, allowing authentication to occur for any user on the system.",
	"notes": {
		"mdeslaur": "per the comments on the oss-sec post, \"pam_krb5 and sssd-krb5 are both affected by the same attack, but they have always been _documented_ to be affected\". See the \"verify_ap_req_nofail\" option in the man page.  Deferring this CVE to see if a fix will be available, or if this isn't something that will ever get a fix because it works as documented."
	},
	"priority": "low",
	"cvss": {
		"nvd": " CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H [9.8 CRITICAL]"
	},
	"mitigation": "Per the documentation, set verify_ap_req_nofail to true in the\n[libdefaults] section of /etc/krb5.conf.",
	"references": [
		"https://security.FreeBSD.org/advisories/FreeBSD-SA-23:04.pam_krb5.asc",
		"https://seclists.org/oss-sec/2023/q2/245",
		"https://www.cve.org/CVERecord?id=CVE-2023-3326"
	],
	"public_date": "2023-06-22 17:15:00 UTC",
	"packages": {
		"bionic": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "ignored",
				"note": "end of standard support"
			},
			"sssd": {
				"name": "sssd",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"devel": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "deferred",
				"note": "2023-06-23"
			},
			"sssd": {
				"name": "sssd",
				"status": "deferred",
				"note": "2023-06-23"
			}
		},
		"esm-infra/bionic": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "deferred",
				"note": "2023-06-23"
			},
			"sssd": {
				"name": "sssd",
				"status": "deferred",
				"note": "2023-06-23"
			}
		},
		"esm-infra/xenial": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "deferred",
				"note": "2023-06-23"
			},
			"sssd": {
				"name": "sssd",
				"status": "deferred",
				"note": "2023-06-23"
			}
		},
		"focal": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "deferred",
				"note": "2023-06-23"
			},
			"sssd": {
				"name": "sssd",
				"status": "deferred",
				"note": "2023-06-23"
			}
		},
		"jammy": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "deferred",
				"note": "2023-06-23"
			},
			"sssd": {
				"name": "sssd",
				"status": "deferred",
				"note": "2023-06-23"
			}
		},
		"kinetic": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "ignored",
				"note": "end of life, was deferred [2023-06-23]"
			},
			"sssd": {
				"name": "sssd",
				"status": "ignored",
				"note": "end of life, was deferred [2023-06-23]"
			}
		},
		"lunar": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "ignored",
				"note": "end of life, was deferred [2023-06-23]"
			},
			"sssd": {
				"name": "sssd",
				"status": "ignored",
				"note": "end of life, was deferred [2023-06-23]"
			}
		},
		"mantic": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "deferred",
				"note": "2023-06-23"
			},
			"sssd": {
				"name": "sssd",
				"status": "deferred",
				"note": "2023-06-23"
			}
		},
		"trusty": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "ignored",
				"note": "end of standard support"
			},
			"sssd": {
				"name": "sssd",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"trusty/esm": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "deferred",
				"note": "2023-06-23"
			}
		},
		"upstream": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "needs-triage"
			},
			"sssd": {
				"name": "sssd",
				"status": "needs-triage"
			}
		},
		"xenial": {
			"libpam-krb5": {
				"name": "libpam-krb5",
				"status": "ignored",
				"note": "end of standard support"
			},
			"sssd": {
				"name": "sssd",
				"status": "ignored",
				"note": "end of standard support"
			}
		}
	}
}
