{
	"candidate": "CVE-2023-3247",
	"description": "In PHP versions 8.0.* before 8.0.29, 8.1.* before 8.1.20, 8.2.* before 8.2.7 when using SOAP HTTP Digest Authentication, random value generator was not checked for failure, and was using narrower range of values than it should have. In case of random generator failure, it could lead to a disclosure of 31 bits of uninitialized memory from the client to the server, and it also made easier to a malicious server to guess the client's nonce.",
	"notes": {
		"rodrigo-zaiden": "the method php_random_bytes_throw that is being used for nonce generation was added in php7.0 with CSPRNG API, so patching versions older than that is not feasible as it would would likely add other issues.",
		"sbeattie": "PEAR issues should go against php-pear as of xenial"
	},
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N [4.3 MEDIUM]"
	},
	"references": [
		"https://github.com/php/php-src/security/advisories/GHSA-76gg-c692-v2mw",
		"https://github.com/php/php-src/commit/ac4254ad764c70cb1f05c9270d8d12689fc3aeb6 (php-8.0.29)",
		"https://github.com/php/php-src/commit/32c7c433ac1983c4497349051681a4f361d3d33e (php-8.0.29)",
		"https://ubuntu.com/security/notices/USN-6199-1",
		"https://ubuntu.com/security/notices/USN-6199-2",
		"https://www.cve.org/CVERecord?id=CVE-2023-3247"
	],
	"public_date": "2023-07-22 05:15:00 UTC",
	"public_date_at_usn": "2023-06-19",
	"packages": {
		"bionic": {
			"php5": {
				"name": "php5",
				"status": "DNE"
			},
			"php7.0": {
				"name": "php7.0",
				"status": "DNE"
			},
			"php7.2": {
				"name": "php7.2",
				"status": "ignored",
				"note": "end of standard support"
			},
			"php7.4": {
				"name": "php7.4",
				"status": "DNE"
			},
			"php8.1": {
				"name": "php8.1",
				"status": "DNE"
			},
			"php8.2": {
				"name": "php8.2",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"devel": {
			"php5": {
				"name": "php5",
				"status": "DNE"
			},
			"php7.0": {
				"name": "php7.0",
				"status": "DNE"
			},
			"php7.2": {
				"name": "php7.2",
				"status": "DNE"
			},
			"php7.4": {
				"name": "php7.4",
				"status": "DNE"
			},
			"php8.1": {
				"name": "php8.1",
				"status": "DNE"
			},
			"php8.2": {
				"name": "php8.2",
				"status": "not-affected",
				"note": "8.2.7-1ubuntu1"
			}
		},
		"esm-infra/bionic": {
			"php7.2": {
				"name": "php7.2",
				"status": "released",
				"note": "7.2.24-0ubuntu0.18.04.17+esm1"
			}
		},
		"esm-infra/xenial": {
			"php7.0": {
				"name": "php7.0",
				"status": "released",
				"note": "7.0.33-0ubuntu0.16.04.16+esm7"
			}
		},
		"focal": {
			"php5": {
				"name": "php5",
				"status": "DNE"
			},
			"php7.0": {
				"name": "php7.0",
				"status": "DNE"
			},
			"php7.2": {
				"name": "php7.2",
				"status": "DNE"
			},
			"php7.4": {
				"name": "php7.4",
				"status": "released",
				"note": "7.4.3-4ubuntu2.19"
			},
			"php8.1": {
				"name": "php8.1",
				"status": "DNE"
			},
			"php8.2": {
				"name": "php8.2",
				"status": "DNE"
			}
		},
		"jammy": {
			"php5": {
				"name": "php5",
				"status": "DNE"
			},
			"php7.0": {
				"name": "php7.0",
				"status": "DNE"
			},
			"php7.2": {
				"name": "php7.2",
				"status": "DNE"
			},
			"php7.4": {
				"name": "php7.4",
				"status": "DNE"
			},
			"php8.1": {
				"name": "php8.1",
				"status": "released",
				"note": "8.1.2-1ubuntu2.13"
			},
			"php8.2": {
				"name": "php8.2",
				"status": "DNE"
			}
		},
		"kinetic": {
			"php5": {
				"name": "php5",
				"status": "DNE"
			},
			"php7.0": {
				"name": "php7.0",
				"status": "DNE"
			},
			"php7.2": {
				"name": "php7.2",
				"status": "DNE"
			},
			"php7.4": {
				"name": "php7.4",
				"status": "DNE"
			},
			"php8.1": {
				"name": "php8.1",
				"status": "released",
				"note": "8.1.7-1ubuntu3.5"
			},
			"php8.2": {
				"name": "php8.2",
				"status": "DNE"
			}
		},
		"lunar": {
			"php5": {
				"name": "php5",
				"status": "DNE"
			},
			"php7.0": {
				"name": "php7.0",
				"status": "DNE"
			},
			"php7.2": {
				"name": "php7.2",
				"status": "DNE"
			},
			"php7.4": {
				"name": "php7.4",
				"status": "DNE"
			},
			"php8.1": {
				"name": "php8.1",
				"status": "released",
				"note": "8.1.12-1ubuntu4.2"
			},
			"php8.2": {
				"name": "php8.2",
				"status": "DNE"
			}
		},
		"mantic": {
			"php5": {
				"name": "php5",
				"status": "DNE"
			},
			"php7.0": {
				"name": "php7.0",
				"status": "DNE"
			},
			"php7.2": {
				"name": "php7.2",
				"status": "DNE"
			},
			"php7.4": {
				"name": "php7.4",
				"status": "DNE"
			},
			"php8.1": {
				"name": "php8.1",
				"status": "DNE"
			},
			"php8.2": {
				"name": "php8.2",
				"status": "not-affected",
				"note": "8.2.7-1ubuntu1"
			}
		},
		"trusty": {
			"php5": {
				"name": "php5",
				"status": "ignored",
				"note": "end of standard support"
			},
			"php7.0": {
				"name": "php7.0",
				"status": "DNE"
			},
			"php7.2": {
				"name": "php7.2",
				"status": "DNE"
			},
			"php7.4": {
				"name": "php7.4",
				"status": "DNE"
			},
			"php8.1": {
				"name": "php8.1",
				"status": "DNE"
			},
			"php8.2": {
				"name": "php8.2",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"trusty/esm": {
			"php5": {
				"name": "php5",
				"status": "ignored",
				"note": "fix not applicable"
			}
		},
		"upstream": {
			"php5": {
				"name": "php5",
				"status": "needs-triage"
			},
			"php7.0": {
				"name": "php7.0",
				"status": "needs-triage"
			},
			"php7.2": {
				"name": "php7.2",
				"status": "needs-triage"
			},
			"php7.4": {
				"name": "php7.4",
				"status": "needs-triage"
			},
			"php8.1": {
				"name": "php8.1",
				"status": "released",
				"note": "8.1.20"
			},
			"php8.2": {
				"name": "php8.2",
				"status": "released",
				"note": "8.2.7-1"
			}
		},
		"xenial": {
			"php5": {
				"name": "php5",
				"status": "DNE"
			},
			"php7.0": {
				"name": "php7.0",
				"status": "ignored",
				"note": "end of standard support"
			},
			"php7.2": {
				"name": "php7.2",
				"status": "DNE"
			},
			"php7.4": {
				"name": "php7.4",
				"status": "DNE"
			},
			"php8.1": {
				"name": "php8.1",
				"status": "DNE"
			},
			"php8.2": {
				"name": "php8.2",
				"status": "ignored",
				"note": "end of standard support"
			}
		}
	}
}
