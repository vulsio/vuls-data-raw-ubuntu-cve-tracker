{
  "candidate": "CVE-2014-1932",
  "description": "The (1) load_djpeg function in JpegImagePlugin.py, (2) Ghostscript function in EpsImagePlugin.py, (3) load function in IptcImagePlugin.py, and (4) _copy function in Image.py in Python Image Library (PIL) 1.1.7 and earlier and Pillow before 2.3.1 do not properly create temporary files, which allow local users to overwrite arbitrary files and obtain sensitive information via a symlink attack on the temporary file.",
  "notes": {
    "seth-arnold": "Normally mktemp() mistakes are classed as 'low' because Ubuntu has hardlink and symlink protections in the kernel. However, one of the discovered flaws is almost certainly also a shell metacharacter injection problem."
  },
  "priority": "medium",
  "bugs": [
    "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=737059"
  ],
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1932",
    "https://ubuntu.com/security/notices/USN-2168-1"
  ],
  "assigned_to": "mdeslaur",
  "discovered_by": "Jakub Wilk",
  "public_date": "2014-04-17 14:55:00 UTC",
  "public_date_at_usn": "2014-02-21",
  "packages": {
    "devel": {
      "pillow": {
        "name": "pillow",
        "status": "released",
        "note": "2.3.0-1ubuntu3",
        "tags": [
          "hardlink-restriction symlink-restriction"
        ]
      },
      "python-imaging": {
        "name": "python-imaging",
        "status": "DNE",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/wiredfool/Pillow/commit/a549e77bd8219a75ac745dcecc09cb963b4032a6 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/wiredfool/Pillow/commit/1e331e3e6a40141ca8eee4f5da9f74e895423b66"
          }
        ]
      }
    },
    "lucid": {
      "pillow": {
        "name": "pillow",
        "status": "DNE",
        "tags": [
          "hardlink-restriction symlink-restriction"
        ]
      },
      "python-imaging": {
        "name": "python-imaging",
        "status": "released",
        "note": "1.1.7-1ubuntu0.2",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/wiredfool/Pillow/commit/a549e77bd8219a75ac745dcecc09cb963b4032a6 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/wiredfool/Pillow/commit/1e331e3e6a40141ca8eee4f5da9f74e895423b66"
          }
        ]
      }
    },
    "precise": {
      "pillow": {
        "name": "pillow",
        "status": "DNE",
        "tags": [
          "hardlink-restriction symlink-restriction"
        ]
      },
      "python-imaging": {
        "name": "python-imaging",
        "status": "released",
        "note": "1.1.7-4ubuntu0.12.04.1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/wiredfool/Pillow/commit/a549e77bd8219a75ac745dcecc09cb963b4032a6 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/wiredfool/Pillow/commit/1e331e3e6a40141ca8eee4f5da9f74e895423b66"
          }
        ]
      }
    },
    "quantal": {
      "pillow": {
        "name": "pillow",
        "status": "DNE",
        "tags": [
          "hardlink-restriction symlink-restriction"
        ]
      },
      "python-imaging": {
        "name": "python-imaging",
        "status": "released",
        "note": "1.1.7-4ubuntu0.12.10.1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/wiredfool/Pillow/commit/a549e77bd8219a75ac745dcecc09cb963b4032a6 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/wiredfool/Pillow/commit/1e331e3e6a40141ca8eee4f5da9f74e895423b66"
          }
        ]
      }
    },
    "saucy": {
      "pillow": {
        "name": "pillow",
        "status": "DNE",
        "tags": [
          "hardlink-restriction symlink-restriction"
        ]
      },
      "python-imaging": {
        "name": "python-imaging",
        "status": "released",
        "note": "1.1.7+2.0.0-1ubuntu1.1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/wiredfool/Pillow/commit/a549e77bd8219a75ac745dcecc09cb963b4032a6 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/wiredfool/Pillow/commit/1e331e3e6a40141ca8eee4f5da9f74e895423b66"
          }
        ]
      }
    },
    "upstream": {
      "pillow": {
        "name": "pillow",
        "status": "needed",
        "tags": [
          "hardlink-restriction symlink-restriction"
        ]
      },
      "python-imaging": {
        "name": "python-imaging",
        "status": "needed",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/wiredfool/Pillow/commit/a549e77bd8219a75ac745dcecc09cb963b4032a6 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/wiredfool/Pillow/commit/1e331e3e6a40141ca8eee4f5da9f74e895423b66"
          }
        ]
      }
    }
  }
}
