{
	"candidate": "CVE-2021-22922",
	"description": "When curl is instructed to download content using the metalink feature, thecontents is verified against a hash provided in the metalink XML file.The metalink XML file points out to the client how to get the same contentfrom a set of different URLs, potentially hosted by different servers and theclient can then download the file from one or several of them. In a serial orparallel manner.If one of the servers hosting the contents has been breached and the contentsof the specific file on that server is replaced with a modified payload, curlshould detect this when the hash of the file mismatches after a completeddownload. It should remove the contents and instead try getting the contentsfrom another URL. This is not done, and instead such a hash mismatch is onlymentioned in text and the potentially malicious content is kept in the file ondisk.",
	"notes": {
		"mdeslaur": "introduced in 7.27.0 per upstream \"curl has completely removed the metalink feature as of 7.78.0. No fix for this flaw will be produced by the curl project. The fix for earlier versions is to rebuild curl with the metalink support switched off!\" Ubuntu builds curl with metalink support switched off already."
	},
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N [6.5 MEDIUM]"
	},
	"references": [
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-22922",
		"https://curl.se/docs/CVE-2021-22922.html"
	],
	"discovered_by": "Harry Sintonen",
	"public_date": "2021-08-05 21:15:00 UTC",
	"crd": "2021-07-21",
	"packages": {
		"bionic": {
			"curl": {
				"name": "curl",
				"status": "not-affected",
				"note": "code not compiled"
			}
		},
		"devel": {
			"curl": {
				"name": "curl",
				"status": "not-affected",
				"note": "code not compiled"
			}
		},
		"esm-infra/bionic": {
			"curl": {
				"name": "curl",
				"status": "not-affected",
				"note": "code not compiled"
			}
		},
		"esm-infra/xenial": {
			"curl": {
				"name": "curl",
				"status": "not-affected",
				"note": "code not compiled"
			}
		},
		"focal": {
			"curl": {
				"name": "curl",
				"status": "not-affected",
				"note": "code not compiled"
			}
		},
		"groovy": {
			"curl": {
				"name": "curl",
				"status": "not-affected",
				"note": "code not compiled"
			}
		},
		"hirsute": {
			"curl": {
				"name": "curl",
				"status": "not-affected",
				"note": "code not compiled"
			}
		},
		"impish": {
			"curl": {
				"name": "curl",
				"status": "not-affected",
				"note": "code not compiled"
			}
		},
		"jammy": {
			"curl": {
				"name": "curl",
				"status": "not-affected",
				"note": "code not compiled"
			}
		},
		"trusty": {
			"curl": {
				"name": "curl",
				"status": "ignored",
				"note": "end of standard support, was not-affected"
			}
		},
		"trusty/esm": {
			"curl": {
				"name": "curl",
				"status": "not-affected",
				"note": "code not compiled"
			}
		},
		"upstream": {
			"curl": {
				"name": "curl",
				"status": "released",
				"note": "7.78.0"
			}
		},
		"xenial": {
			"curl": {
				"name": "curl",
				"status": "ignored",
				"note": "end of standard support, was not-affected"
			}
		}
	}
}
