{
	"candidate": "CVE-2021-23240",
	"description": "selinux_edit_copy_tfiles in sudoedit in Sudo before 1.9.5 allows a local unprivileged user to gain file ownership and escalate privileges by replacing a temporary file with a symlink to an arbitrary file target. This affects SELinux RBAC support in permissive mode. Machines without SELinux are not vulnerable.",
	"notes": {
		"rodrigo-zaiden": "fs.protected_symlinks is '1' by default in Ubuntu, and if not changed, can prevent this issue from being exploited.  There are backports available for version 1.8 but not straightforward for 1.8.16 (xenial baseline). Some of the selinux specific code that needs to be patched was added later in time and it seems to me that the backports for 1.8 are based on 1.8.32. So, in xenial, a fix would be very intrusive and likely to introduce a regression. The reproducer in sudo.ws reference does not reproduce in xenial. The fact that the reproducer does not reproduce, that the kernel hardening fs.protected_symlinks is '1' by default (with no clear reason to be turned off to '0'), that there is a very low possibility to have Ubuntu running selinux without a working policy and, mainly, that the risky of regression is high, we are marking this CVE as ignored for xenial.",
		"sbeattie": "selinux is not the default MAC in Ubuntu, though users can boot into it."
	},
	"priority": "negligible",
	"cvss": {
		"nvd": " CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [7.8 HIGH]"
	},
	"references": [
		"https://www.openwall.com/lists/oss-security/2021/01/11/2",
		"https://www.sudo.ws/alerts/sudoedit_selinux.html",
		"https://www.cve.org/CVERecord?id=CVE-2021-23240"
	],
	"discovered_by": "Matthias Gerstner",
	"public_date": "2021-01-12 09:15:00 UTC",
	"packages": {
		"bionic": {
			"sudo": {
				"name": "sudo",
				"status": "ignored",
				"note": "end of standard support, was needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"devel": {
			"sudo": {
				"name": "sudo",
				"status": "not-affected",
				"note": "1.9.9-1ubuntu2",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"esm-infra/bionic": {
			"sudo": {
				"name": "sudo",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"esm-infra/xenial": {
			"sudo": {
				"name": "sudo",
				"status": "ignored",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"focal": {
			"sudo": {
				"name": "sudo",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"groovy": {
			"sudo": {
				"name": "sudo",
				"status": "ignored",
				"note": "end of life",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"hirsute": {
			"sudo": {
				"name": "sudo",
				"status": "ignored",
				"note": "end of life",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"impish": {
			"sudo": {
				"name": "sudo",
				"status": "not-affected",
				"note": "1.9.5p2-3ubuntu1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"jammy": {
			"sudo": {
				"name": "sudo",
				"status": "not-affected",
				"note": "1.9.9-1ubuntu2",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"kinetic": {
			"sudo": {
				"name": "sudo",
				"status": "not-affected",
				"note": "1.9.9-1ubuntu2",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"lunar": {
			"sudo": {
				"name": "sudo",
				"status": "not-affected",
				"note": "1.9.9-1ubuntu2",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"mantic": {
			"sudo": {
				"name": "sudo",
				"status": "not-affected",
				"note": "1.9.9-1ubuntu2",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"precise/esm": {
			"sudo": {
				"name": "sudo",
				"status": "ignored",
				"note": "end of life, was needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"trusty": {
			"sudo": {
				"name": "sudo",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"trusty/esm": {
			"sudo": {
				"name": "sudo",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"upstream": {
			"sudo": {
				"name": "sudo",
				"status": "released",
				"note": "1.9.5",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		},
		"xenial": {
			"sudo": {
				"name": "sudo",
				"status": "ignored",
				"note": "end of standard support, was needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/8fcb36ef422a"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/b5d5bd506487"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/593ce9fdf5dd (1.8)"
					},
					{
						"source": "upstream",
						"text": "https://www.sudo.ws/repos/sudo/rev/645752e64b72 (1.8)"
					}
				]
			}
		}
	}
}
