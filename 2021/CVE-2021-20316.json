{
	"candidate": "CVE-2021-20316",
	"description": "A flaw was found in the way Samba handled file/directory metadata. This flaw allows an authenticated attacker with permissions to read or modify share metadata, to perform this operation outside of the share.",
	"notes": {
		"mdeslaur": "per upstream, fixing this required a whole rewrite of the VFS layer and there is no reasonable way to fix this in older versions. Marking this CVE as ignored for older releases."
	},
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N [6.8 MEDIUM]"
	},
	"mitigation": "This issue can be mitigated by disabling SMB1, which is the default\nconfiguration in Samba 4.11 and above. In environments where SMB1 cannot\nbe disabled, symlink support can be disabled with unix extensions = no.",
	"bugs": [
		"https://bugzilla.samba.org/show_bug.cgi?id=14842"
	],
	"references": [
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20316",
		"https://www.samba.org/samba/security/CVE-2021-20316.html"
	],
	"discovered_by": "Michael Hanselmann",
	"public_date": "2022-08-23 16:15:00 UTC",
	"packages": {
		"bionic": {
			"samba": {
				"name": "samba",
				"status": "ignored"
			}
		},
		"devel": {
			"samba": {
				"name": "samba",
				"status": "not-affected",
				"note": "2:4.16.4+dfsg-2ubuntu1"
			}
		},
		"esm-infra/bionic": {
			"samba": {
				"name": "samba",
				"status": "ignored"
			}
		},
		"esm-infra/xenial": {
			"samba": {
				"name": "samba",
				"status": "needed"
			}
		},
		"focal": {
			"samba": {
				"name": "samba",
				"status": "ignored"
			}
		},
		"hirsute": {
			"samba": {
				"name": "samba",
				"status": "ignored"
			}
		},
		"impish": {
			"samba": {
				"name": "samba",
				"status": "ignored"
			}
		},
		"jammy": {
			"samba": {
				"name": "samba",
				"status": "ignored"
			}
		},
		"kinetic": {
			"samba": {
				"name": "samba",
				"status": "ignored"
			}
		},
		"lunar": {
			"samba": {
				"name": "samba",
				"status": "not-affected",
				"note": "2:4.16.4+dfsg-2ubuntu1"
			}
		},
		"mantic": {
			"samba": {
				"name": "samba",
				"status": "not-affected",
				"note": "2:4.16.4+dfsg-2ubuntu1"
			}
		},
		"trusty": {
			"samba": {
				"name": "samba",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"trusty/esm": {
			"samba": {
				"name": "samba",
				"status": "needed"
			}
		},
		"upstream": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "4.15.0"
			}
		},
		"xenial": {
			"samba": {
				"name": "samba",
				"status": "ignored",
				"note": "end of standard support"
			}
		}
	}
}
