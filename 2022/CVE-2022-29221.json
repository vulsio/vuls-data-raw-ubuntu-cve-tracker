{
	"candidate": "CVE-2022-29221",
	"description": "Smarty is a template engine for PHP, facilitating the separation of presentation (HTML/CSS) from application logic. Prior to versions 3.1.45 and 4.1.1, template authors could inject php code by choosing a malicious {block} name or {include} file name. Sites that cannot fully trust template authors should upgrade to versions 3.1.45 or 4.1.1 to receive a patch for this issue. There are currently no known workarounds.",
	"notes": {
		"ccdm94": "postfixadmin does not contain embedded copies of smarty in trusty and xenial. In bionic, postfixadmin contains an embedded smarty copy at version 3.1.29, while in jammy it contains an embedded copy at version 3.1.33. In lunar and mantic this copy is at version 4.3.0."
	},
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]"
	},
	"bugs": [
		"http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1011757",
		"http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1011758"
	],
	"references": [
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-29221",
		"https://github.com/smarty-php/smarty/security/advisories/GHSA-634x-pc3q-cf4c",
		"https://github.com/smarty-php/smarty/commit/64ad6442ca1da31cefdab5c9874262b702cccddd (v4.1.1)",
		"https://github.com/smarty-php/smarty/commit/3606c4717ed6348e114a610ff1e446048dcd0345 (v3.1.45)",
		"https://github.com/smarty-php/smarty/releases/tag/v3.1.45",
		"https://github.com/smarty-php/smarty/commit/64ad6442ca1da31cefdab5c9874262b702cccddd",
		"https://github.com/smarty-php/smarty/releases/tag/v4.1.1",
		"https://ubuntu.com/security/notices/USN-6012-1"
	],
	"assigned_to": "iosifache, ccdm94 (postfixadmin)",
	"public_date": "2022-05-24 15:15:00 UTC",
	"public_date_at_usn": "2022-05-24 15:15:00 UTC",
	"packages": {
		"bionic": {
			"gosa": {
				"name": "gosa",
				"status": "ignored",
				"note": "end of standard support, was needs-triage"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "ignored",
				"note": "end of standard support, was needed"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "ignored",
				"note": "end of standard support, was needs-triage"
			}
		},
		"devel": {
			"gosa": {
				"name": "gosa",
				"status": "needs-triage"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "not-affected",
				"note": "see notes"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "released",
				"note": "3.1.39-2ubuntu2"
			},
			"smarty4": {
				"name": "smarty4",
				"status": "needs-triage"
			}
		},
		"esm-apps/bionic": {
			"gosa": {
				"name": "gosa",
				"status": "needs-triage"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "needed"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "needs-triage"
			}
		},
		"esm-apps/focal": {
			"gosa": {
				"name": "gosa",
				"status": "needs-triage"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "needed"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "needs-triage"
			}
		},
		"esm-apps/jammy": {
			"gosa": {
				"name": "gosa",
				"status": "needs-triage"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "needed"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "needs-triage"
			}
		},
		"esm-apps/xenial": {
			"collabtive": {
				"name": "collabtive",
				"status": "needs-triage"
			},
			"galette": {
				"name": "galette",
				"status": "needs-triage"
			},
			"gosa": {
				"name": "gosa",
				"status": "needs-triage"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "not-affected",
				"note": "code not present"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "needs-triage"
			}
		},
		"focal": {
			"gosa": {
				"name": "gosa",
				"status": "needs-triage"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "needed"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "needs-triage"
			}
		},
		"impish": {
			"gosa": {
				"name": "gosa",
				"status": "ignored",
				"note": "end of life"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "ignored",
				"note": "end of life"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "ignored",
				"note": "end of life"
			}
		},
		"jammy": {
			"gosa": {
				"name": "gosa",
				"status": "needs-triage"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "needed"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "released",
				"note": "3.1.39-2ubuntu1.22.04.1"
			}
		},
		"kinetic": {
			"gosa": {
				"name": "gosa",
				"status": "ignored",
				"note": "end of life, was needs-triage"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "ignored",
				"note": "end of life, was needs-triage"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "released",
				"note": "3.1.39-2ubuntu1.22.10.1"
			},
			"smarty4": {
				"name": "smarty4",
				"status": "ignored",
				"note": "end of life, was needs-triage"
			}
		},
		"lunar": {
			"gosa": {
				"name": "gosa",
				"status": "needs-triage"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "not-affected",
				"note": "see notes"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "released",
				"note": "3.1.39-2ubuntu2"
			},
			"smarty4": {
				"name": "smarty4",
				"status": "needs-triage"
			}
		},
		"mantic": {
			"gosa": {
				"name": "gosa",
				"status": "needs-triage"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "not-affected",
				"note": "see notes"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "released",
				"note": "3.1.39-2ubuntu2"
			},
			"smarty4": {
				"name": "smarty4",
				"status": "needs-triage"
			}
		},
		"upstream": {
			"collabtive": {
				"name": "collabtive",
				"status": "needs-triage"
			},
			"galette": {
				"name": "galette",
				"status": "needs-triage"
			},
			"gosa": {
				"name": "gosa",
				"status": "needs-triage"
			},
			"postfixadmin": {
				"name": "postfixadmin",
				"status": "needed"
			},
			"smarty3": {
				"name": "smarty3",
				"status": "needs-triage"
			},
			"smarty4": {
				"name": "smarty4",
				"status": "needs-triage"
			}
		}
	}
}
