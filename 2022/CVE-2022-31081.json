{
  "candidate": "CVE-2022-31081",
  "description": "HTTP::Daemon is a simple http server class written in perl. Versions prior to 6.15 are subject to a vulnerability which could potentially be exploited to gain privileged access to APIs or poison intermediate caches. It is uncertain how large the risks are, most Perl based applications are served on top of Nginx or Apache, not on the `HTTP::Daemon`. This library is commonly used for local development and tests. Users are advised to update to resolve this issue. Users unable to upgrade may add additional request handling logic as a mitigation. After calling `my $rqst = $conn->get_request()` one could inspect the returned `HTTP::Request` object. Querying the 'Content-Length' (`my $cl = $rqst->header('Content-Length')`) will show any abnormalities that should be dealt with by a `400` response. Expected strings of 'Content-Length' SHOULD consist of either a single non-negative integer, or, a comma separated repetition of that number. (that is `42` or `42, 42, 42`). Anything else MUST be rejected.",
  "priority": "medium",
  "cvss": {
    "nvd": " CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N [6.5 MEDIUM]"
  },
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-31081",
    "https://github.com/libwww-perl/HTTP-Daemon/security/advisories/GHSA-cg8c-pxmv-w7cf",
    "http://metacpan.org/release/HTTP-Daemon/",
    "https://cwe.mitre.org/data/definitions/444.html",
    "https://datatracker.ietf.org/doc/html/rfc7230#section-9.5",
    "https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn",
    "https://ubuntu.com/security/notices/USN-5520-1",
    "https://ubuntu.com/security/notices/USN-5520-2"
  ],
  "assigned_to": "mdeslaur",
  "public_date": "2022-06-27 21:15:00 UTC",
  "public_date_at_usn": "2022-06-27 21:15:00 UTC",
  "packages": {
    "bionic": {
      "libhttp-daemon-perl": {
        "name": "libhttp-daemon-perl",
        "status": "released",
        "note": "6.01-1ubuntu0.1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/331d5c1d1f0e48e6b57ef738c2a8509b1eb53376 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/8dc5269d59e2d5d9eb1647d82c449ccd880f7fd0"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/e84475de51d6fd7b29354a997413472a99db70b2"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/faebad54455c2c2919e234202362570925fb99d1 (test)"
          }
        ]
      }
    },
    "devel": {
      "libhttp-daemon-perl": {
        "name": "libhttp-daemon-perl",
        "status": "released",
        "note": "6.14-1ubuntu1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/331d5c1d1f0e48e6b57ef738c2a8509b1eb53376 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/8dc5269d59e2d5d9eb1647d82c449ccd880f7fd0"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/e84475de51d6fd7b29354a997413472a99db70b2"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/faebad54455c2c2919e234202362570925fb99d1 (test)"
          }
        ]
      }
    },
    "esm-infra/bionic": {
      "libhttp-daemon-perl": {
        "name": "libhttp-daemon-perl",
        "status": "released",
        "note": "6.01-1ubuntu0.1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/331d5c1d1f0e48e6b57ef738c2a8509b1eb53376 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/8dc5269d59e2d5d9eb1647d82c449ccd880f7fd0"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/e84475de51d6fd7b29354a997413472a99db70b2"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/faebad54455c2c2919e234202362570925fb99d1 (test)"
          }
        ]
      }
    },
    "esm-infra/xenial": {
      "libhttp-daemon-perl": {
        "name": "libhttp-daemon-perl",
        "status": "released",
        "note": "6.01-1ubuntu0.16.04~esm1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/331d5c1d1f0e48e6b57ef738c2a8509b1eb53376 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/8dc5269d59e2d5d9eb1647d82c449ccd880f7fd0"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/e84475de51d6fd7b29354a997413472a99db70b2"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/faebad54455c2c2919e234202362570925fb99d1 (test)"
          }
        ]
      }
    },
    "focal": {
      "libhttp-daemon-perl": {
        "name": "libhttp-daemon-perl",
        "status": "released",
        "note": "6.06-1ubuntu0.1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/331d5c1d1f0e48e6b57ef738c2a8509b1eb53376 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/8dc5269d59e2d5d9eb1647d82c449ccd880f7fd0"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/e84475de51d6fd7b29354a997413472a99db70b2"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/faebad54455c2c2919e234202362570925fb99d1 (test)"
          }
        ]
      }
    },
    "impish": {
      "libhttp-daemon-perl": {
        "name": "libhttp-daemon-perl",
        "status": "ignored",
        "note": "end of life",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/331d5c1d1f0e48e6b57ef738c2a8509b1eb53376 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/8dc5269d59e2d5d9eb1647d82c449ccd880f7fd0"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/e84475de51d6fd7b29354a997413472a99db70b2"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/faebad54455c2c2919e234202362570925fb99d1 (test)"
          }
        ]
      }
    },
    "jammy": {
      "libhttp-daemon-perl": {
        "name": "libhttp-daemon-perl",
        "status": "released",
        "note": "6.13-1ubuntu0.1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/331d5c1d1f0e48e6b57ef738c2a8509b1eb53376 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/8dc5269d59e2d5d9eb1647d82c449ccd880f7fd0"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/e84475de51d6fd7b29354a997413472a99db70b2"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/faebad54455c2c2919e234202362570925fb99d1 (test)"
          }
        ]
      }
    },
    "kinetic": {
      "libhttp-daemon-perl": {
        "name": "libhttp-daemon-perl",
        "status": "released",
        "note": "6.14-1ubuntu1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/331d5c1d1f0e48e6b57ef738c2a8509b1eb53376 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/8dc5269d59e2d5d9eb1647d82c449ccd880f7fd0"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/e84475de51d6fd7b29354a997413472a99db70b2"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/faebad54455c2c2919e234202362570925fb99d1 (test)"
          }
        ]
      }
    },
    "trusty": {
      "libhttp-daemon-perl": {
        "name": "libhttp-daemon-perl",
        "status": "ignored",
        "note": "end of standard support, was needs-triage",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/331d5c1d1f0e48e6b57ef738c2a8509b1eb53376 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/8dc5269d59e2d5d9eb1647d82c449ccd880f7fd0"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/e84475de51d6fd7b29354a997413472a99db70b2"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/faebad54455c2c2919e234202362570925fb99d1 (test)"
          }
        ]
      }
    },
    "trusty/esm": {
      "libhttp-daemon-perl": {
        "name": "libhttp-daemon-perl",
        "status": "released",
        "note": "6.01-1ubuntu0.14.04~esm1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/331d5c1d1f0e48e6b57ef738c2a8509b1eb53376 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/8dc5269d59e2d5d9eb1647d82c449ccd880f7fd0"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/e84475de51d6fd7b29354a997413472a99db70b2"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/faebad54455c2c2919e234202362570925fb99d1 (test)"
          }
        ]
      }
    },
    "upstream": {
      "libhttp-daemon-perl": {
        "name": "libhttp-daemon-perl",
        "status": "pending",
        "note": "6.15",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/331d5c1d1f0e48e6b57ef738c2a8509b1eb53376 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/8dc5269d59e2d5d9eb1647d82c449ccd880f7fd0"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/e84475de51d6fd7b29354a997413472a99db70b2"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/faebad54455c2c2919e234202362570925fb99d1 (test)"
          }
        ]
      }
    },
    "xenial": {
      "libhttp-daemon-perl": {
        "name": "libhttp-daemon-perl",
        "status": "ignored",
        "note": "end of standard support, was needs-triage",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/331d5c1d1f0e48e6b57ef738c2a8509b1eb53376 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/8dc5269d59e2d5d9eb1647d82c449ccd880f7fd0"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/e84475de51d6fd7b29354a997413472a99db70b2"
          },
          {
            "source": "upstream",
            "text": "https://github.com/libwww-perl/HTTP-Daemon/commit/faebad54455c2c2919e234202362570925fb99d1 (test)"
          }
        ]
      }
    }
  }
}
