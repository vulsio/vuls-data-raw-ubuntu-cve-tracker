{
	"candidate": "CVE-2022-2031",
	"description": "A flaw was found in Samba. The security vulnerability occurs when KDC and the kpasswd service share a single account and set of keys, allowing them to decrypt each other's tickets. A user who has been requested to change their password, can exploit this flaw to obtain and use tickets to other services.",
	"notes": {
		"mdeslaur": "Fixing this in Ubuntu 18.04 LTS would require substantial code backports. We will not be fixing this issue in Ubuntu 18.04 LTS. In environments where this is of concern, we recommend updating to a more recent Ubuntu version, or disabling kpasswd if this is not passible."
	},
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H [8.8 HIGH]"
	},
	"mitigation": "kpasswd is not a critical protocol for the AD DC in most installations, it\ncan be disabled by setting \"kpasswd port = 0\" in the smb.conf.",
	"bugs": [
		"https://bugzilla.samba.org/show_bug.cgi?id=15047",
		"https://bugzilla.samba.org/show_bug.cgi?id=15109 (tracking bug)"
	],
	"references": [
		"https://www.samba.org/samba/security/CVE-2022-2031.html",
		"https://ubuntu.com/security/notices/USN-5542-1",
		"https://www.cve.org/CVERecord?id=CVE-2022-2031"
	],
	"discovered_by": "Luke Howard",
	"public_date": "2022-08-25 18:15:00 UTC",
	"public_date_at_usn": "2022-07-27",
	"crd": "2022-07-27",
	"packages": {
		"bionic": {
			"samba": {
				"name": "samba",
				"status": "ignored"
			}
		},
		"devel": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.16.4+dfsg-2ubuntu1"
			}
		},
		"esm-infra-legacy/trusty": {
			"samba": {
				"name": "samba",
				"status": "needed"
			}
		},
		"esm-infra/bionic": {
			"samba": {
				"name": "samba",
				"status": "ignored"
			}
		},
		"esm-infra/xenial": {
			"samba": {
				"name": "samba",
				"status": "needed"
			}
		},
		"focal": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.13.17~dfsg-0ubuntu1.20.04.1"
			}
		},
		"impish": {
			"samba": {
				"name": "samba",
				"status": "ignored",
				"note": "end of life"
			}
		},
		"jammy": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.15.9+dfsg-0ubuntu0.2"
			}
		},
		"kinetic": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.16.4+dfsg-2ubuntu1"
			}
		},
		"lunar": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.16.4+dfsg-2ubuntu1"
			}
		},
		"mantic": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.16.4+dfsg-2ubuntu1"
			}
		},
		"noble": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.16.4+dfsg-2ubuntu1"
			}
		},
		"trusty": {
			"samba": {
				"name": "samba",
				"status": "DNE"
			}
		},
		"trusty/esm": {
			"samba": {
				"name": "samba",
				"status": "needed"
			}
		},
		"upstream": {
			"samba": {
				"name": "samba",
				"status": "needs-triage"
			}
		},
		"xenial": {
			"samba": {
				"name": "samba",
				"status": "DNE"
			}
		}
	}
}
