{
	"candidate": "CVE-2022-32746",
	"description": "A flaw was found in the Samba AD LDAP server. The AD DC database audit logging module can access LDAP message values freed by a preceding database module, resulting in a use-after-free issue. This issue is only possible when modifying certain privileged attributes, such as userAccountControl.",
	"notes": {
		"mdeslaur": "combined patches are in bug 15096 Fixing this in Ubuntu 18.04 LTS would require substantial code backports. We will not be fixing this issue in Ubuntu 18.04 LTS. In environments where this is of concern, we recommend updating to a more recent Ubuntu version, or disabling AD DC database audit logging if this is not passible."
	},
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L [5.4 MEDIUM]"
	},
	"mitigation": "Disabling AD DC database audit logging prevents the use-after-free from\noccurring, as that is the only component that will access the original\nmessage.",
	"bugs": [
		"https://bugzilla.samba.org/show_bug.cgi?id=15009",
		"https://bugzilla.samba.org/show_bug.cgi?id=15096",
		"https://bugzilla.samba.org/show_bug.cgi?id=15109 (tracking bug)"
	],
	"references": [
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-32746",
		"https://www.samba.org/samba/security/CVE-2022-32746.html",
		"https://ubuntu.com/security/notices/USN-5542-1"
	],
	"discovered_by": "Joseph Sutton and Andrew Bartlett",
	"public_date": "2022-08-25 18:15:00 UTC",
	"public_date_at_usn": "2022-07-27",
	"crd": "2022-07-27",
	"packages": {
		"bionic": {
			"ldb": {
				"name": "ldb",
				"status": "ignored"
			},
			"samba": {
				"name": "samba",
				"status": "ignored"
			}
		},
		"devel": {
			"ldb": {
				"name": "ldb",
				"status": "DNE"
			},
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.16.4+dfsg-2ubuntu1"
			}
		},
		"esm-infra/bionic": {
			"ldb": {
				"name": "ldb",
				"status": "ignored"
			},
			"samba": {
				"name": "samba",
				"status": "ignored"
			}
		},
		"esm-infra/xenial": {
			"ldb": {
				"name": "ldb",
				"status": "needs-triage"
			},
			"samba": {
				"name": "samba",
				"status": "needs-triage"
			}
		},
		"focal": {
			"ldb": {
				"name": "ldb",
				"status": "released",
				"note": "2:2.2.3-0ubuntu0.20.04.3"
			},
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.13.17~dfsg-0ubuntu1.20.04.1"
			}
		},
		"impish": {
			"ldb": {
				"name": "ldb",
				"status": "ignored",
				"note": "end of life"
			},
			"samba": {
				"name": "samba",
				"status": "ignored",
				"note": "end of life"
			}
		},
		"jammy": {
			"ldb": {
				"name": "ldb",
				"status": "released",
				"note": "2:2.4.4-0ubuntu0.1"
			},
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.15.9+dfsg-0ubuntu0.2"
			}
		},
		"kinetic": {
			"ldb": {
				"name": "ldb",
				"status": "DNE"
			},
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.16.4+dfsg-2ubuntu1"
			}
		},
		"lunar": {
			"ldb": {
				"name": "ldb",
				"status": "DNE"
			},
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.16.4+dfsg-2ubuntu1"
			}
		},
		"mantic": {
			"ldb": {
				"name": "ldb",
				"status": "DNE"
			},
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.16.4+dfsg-2ubuntu1"
			}
		},
		"trusty": {
			"samba": {
				"name": "samba",
				"status": "DNE"
			}
		},
		"trusty/esm": {
			"ldb": {
				"name": "ldb",
				"status": "needs-triage"
			},
			"samba": {
				"name": "samba",
				"status": "needs-triage"
			}
		},
		"upstream": {
			"ldb": {
				"name": "ldb",
				"status": "needs-triage"
			},
			"samba": {
				"name": "samba",
				"status": "needs-triage"
			}
		},
		"xenial": {
			"samba": {
				"name": "samba",
				"status": "DNE"
			}
		}
	}
}
