{
  "candidate": "CVE-2015-3153",
  "description": "The default configuration for cURL and libcurl before 7.42.1 sends custom HTTP headers to both the proxy and destination server, which might allow remote proxy servers to obtain sensitive information by reading the header contents.",
  "notes": {
    "mdeslaur": "in curl versions before 7.37.0, the same headers are always sent to both the destination server and the proxy. In 7.37.0, two new options were introduced to control which headers are sent to the server and which headers are sent to the proxy: CURLOPT_HEADEROPT and CURLOPT_PROXYHEADER. The default is to send the headers to both servers, contrary to expectations. The fix is to change the default to send separate headers.  Introducing split header functionality in older versions of curl is intrusive, and will change behaviour. We will not be fixing this issue in Ubuntu 14.04 LTS and earlier."
  },
  "priority": "medium",
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-3153",
    "http://curl.haxx.se/docs/adv_20150429.html",
    "https://ubuntu.com/security/notices/USN-2591-1"
  ],
  "assigned_to": "mdeslaur",
  "discovered_by": "Yehezkel Horowitz and Oren Souroujon",
  "public_date": "2015-05-01 15:59:00 UTC",
  "public_date_at_usn": "2015-04-29",
  "packages": {
    "devel": {
      "curl": {
        "name": "curl",
        "status": "DNE",
        "patches": [
          {
            "source": "upstream",
            "text": "http://curl.haxx.se/CVE-2015-3153.patch"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ac887eedbc17a0d78b11ff467858c76a5127d1f4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ef6be35bae1fe501fecd9a2a21eb5d03ddff4243 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/fa0a5e6812f9e460f4f2d9aae0ca9900fd50add4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/4946ea05e2ae14bd84332bd1fde5e3b5e468cef2 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/20f61cd12c9b7960a9e5489154744af6c7583aac (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/d3d27551e716e4899ef8fea7ac416f1d6c654f96 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/74851340bd7b4edbdc749e74562fc1ebcef9930f (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/109e94c51cf813eb3f69e22556cb990d4eec5ac3 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/c877c50e13ad43459de12a4092bd95872e549dfb (bp)"
          }
        ]
      }
    },
    "lucid": {
      "curl": {
        "name": "curl",
        "status": "ignored",
        "note": "end of life",
        "patches": [
          {
            "source": "upstream",
            "text": "http://curl.haxx.se/CVE-2015-3153.patch"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ac887eedbc17a0d78b11ff467858c76a5127d1f4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ef6be35bae1fe501fecd9a2a21eb5d03ddff4243 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/fa0a5e6812f9e460f4f2d9aae0ca9900fd50add4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/4946ea05e2ae14bd84332bd1fde5e3b5e468cef2 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/20f61cd12c9b7960a9e5489154744af6c7583aac (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/d3d27551e716e4899ef8fea7ac416f1d6c654f96 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/74851340bd7b4edbdc749e74562fc1ebcef9930f (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/109e94c51cf813eb3f69e22556cb990d4eec5ac3 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/c877c50e13ad43459de12a4092bd95872e549dfb (bp)"
          }
        ]
      }
    },
    "precise": {
      "curl": {
        "name": "curl",
        "status": "ignored",
        "patches": [
          {
            "source": "upstream",
            "text": "http://curl.haxx.se/CVE-2015-3153.patch"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ac887eedbc17a0d78b11ff467858c76a5127d1f4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ef6be35bae1fe501fecd9a2a21eb5d03ddff4243 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/fa0a5e6812f9e460f4f2d9aae0ca9900fd50add4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/4946ea05e2ae14bd84332bd1fde5e3b5e468cef2 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/20f61cd12c9b7960a9e5489154744af6c7583aac (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/d3d27551e716e4899ef8fea7ac416f1d6c654f96 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/74851340bd7b4edbdc749e74562fc1ebcef9930f (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/109e94c51cf813eb3f69e22556cb990d4eec5ac3 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/c877c50e13ad43459de12a4092bd95872e549dfb (bp)"
          }
        ]
      }
    },
    "trusty": {
      "curl": {
        "name": "curl",
        "status": "ignored",
        "patches": [
          {
            "source": "upstream",
            "text": "http://curl.haxx.se/CVE-2015-3153.patch"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ac887eedbc17a0d78b11ff467858c76a5127d1f4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ef6be35bae1fe501fecd9a2a21eb5d03ddff4243 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/fa0a5e6812f9e460f4f2d9aae0ca9900fd50add4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/4946ea05e2ae14bd84332bd1fde5e3b5e468cef2 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/20f61cd12c9b7960a9e5489154744af6c7583aac (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/d3d27551e716e4899ef8fea7ac416f1d6c654f96 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/74851340bd7b4edbdc749e74562fc1ebcef9930f (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/109e94c51cf813eb3f69e22556cb990d4eec5ac3 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/c877c50e13ad43459de12a4092bd95872e549dfb (bp)"
          }
        ]
      }
    },
    "trusty/esm": {
      "curl": {
        "name": "curl",
        "status": "ignored",
        "patches": [
          {
            "source": "upstream",
            "text": "http://curl.haxx.se/CVE-2015-3153.patch"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ac887eedbc17a0d78b11ff467858c76a5127d1f4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ef6be35bae1fe501fecd9a2a21eb5d03ddff4243 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/fa0a5e6812f9e460f4f2d9aae0ca9900fd50add4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/4946ea05e2ae14bd84332bd1fde5e3b5e468cef2 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/20f61cd12c9b7960a9e5489154744af6c7583aac (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/d3d27551e716e4899ef8fea7ac416f1d6c654f96 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/74851340bd7b4edbdc749e74562fc1ebcef9930f (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/109e94c51cf813eb3f69e22556cb990d4eec5ac3 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/c877c50e13ad43459de12a4092bd95872e549dfb (bp)"
          }
        ]
      }
    },
    "upstream": {
      "curl": {
        "name": "curl",
        "status": "released",
        "note": "7.42.1",
        "patches": [
          {
            "source": "upstream",
            "text": "http://curl.haxx.se/CVE-2015-3153.patch"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ac887eedbc17a0d78b11ff467858c76a5127d1f4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ef6be35bae1fe501fecd9a2a21eb5d03ddff4243 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/fa0a5e6812f9e460f4f2d9aae0ca9900fd50add4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/4946ea05e2ae14bd84332bd1fde5e3b5e468cef2 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/20f61cd12c9b7960a9e5489154744af6c7583aac (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/d3d27551e716e4899ef8fea7ac416f1d6c654f96 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/74851340bd7b4edbdc749e74562fc1ebcef9930f (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/109e94c51cf813eb3f69e22556cb990d4eec5ac3 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/c877c50e13ad43459de12a4092bd95872e549dfb (bp)"
          }
        ]
      }
    },
    "utopic": {
      "curl": {
        "name": "curl",
        "status": "released",
        "note": "7.37.1-1ubuntu3.4",
        "patches": [
          {
            "source": "upstream",
            "text": "http://curl.haxx.se/CVE-2015-3153.patch"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ac887eedbc17a0d78b11ff467858c76a5127d1f4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ef6be35bae1fe501fecd9a2a21eb5d03ddff4243 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/fa0a5e6812f9e460f4f2d9aae0ca9900fd50add4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/4946ea05e2ae14bd84332bd1fde5e3b5e468cef2 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/20f61cd12c9b7960a9e5489154744af6c7583aac (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/d3d27551e716e4899ef8fea7ac416f1d6c654f96 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/74851340bd7b4edbdc749e74562fc1ebcef9930f (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/109e94c51cf813eb3f69e22556cb990d4eec5ac3 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/c877c50e13ad43459de12a4092bd95872e549dfb (bp)"
          }
        ]
      }
    },
    "vivid": {
      "curl": {
        "name": "curl",
        "status": "released",
        "note": "7.38.0-3ubuntu2.2",
        "patches": [
          {
            "source": "upstream",
            "text": "http://curl.haxx.se/CVE-2015-3153.patch"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ac887eedbc17a0d78b11ff467858c76a5127d1f4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ef6be35bae1fe501fecd9a2a21eb5d03ddff4243 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/fa0a5e6812f9e460f4f2d9aae0ca9900fd50add4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/4946ea05e2ae14bd84332bd1fde5e3b5e468cef2 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/20f61cd12c9b7960a9e5489154744af6c7583aac (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/d3d27551e716e4899ef8fea7ac416f1d6c654f96 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/74851340bd7b4edbdc749e74562fc1ebcef9930f (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/109e94c51cf813eb3f69e22556cb990d4eec5ac3 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/c877c50e13ad43459de12a4092bd95872e549dfb (bp)"
          }
        ]
      }
    },
    "vivid/stable-phone-overlay": {
      "curl": {
        "name": "curl",
        "status": "released",
        "note": "7.38.0-3ubuntu2.2",
        "patches": [
          {
            "source": "upstream",
            "text": "http://curl.haxx.se/CVE-2015-3153.patch"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ac887eedbc17a0d78b11ff467858c76a5127d1f4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ef6be35bae1fe501fecd9a2a21eb5d03ddff4243 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/fa0a5e6812f9e460f4f2d9aae0ca9900fd50add4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/4946ea05e2ae14bd84332bd1fde5e3b5e468cef2 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/20f61cd12c9b7960a9e5489154744af6c7583aac (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/d3d27551e716e4899ef8fea7ac416f1d6c654f96 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/74851340bd7b4edbdc749e74562fc1ebcef9930f (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/109e94c51cf813eb3f69e22556cb990d4eec5ac3 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/c877c50e13ad43459de12a4092bd95872e549dfb (bp)"
          }
        ]
      }
    },
    "vivid/ubuntu-core": {
      "curl": {
        "name": "curl",
        "status": "released",
        "note": "7.38.0-3ubuntu2.2",
        "patches": [
          {
            "source": "upstream",
            "text": "http://curl.haxx.se/CVE-2015-3153.patch"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ac887eedbc17a0d78b11ff467858c76a5127d1f4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/ef6be35bae1fe501fecd9a2a21eb5d03ddff4243 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/fa0a5e6812f9e460f4f2d9aae0ca9900fd50add4 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/4946ea05e2ae14bd84332bd1fde5e3b5e468cef2 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/20f61cd12c9b7960a9e5489154744af6c7583aac (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/d3d27551e716e4899ef8fea7ac416f1d6c654f96 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/74851340bd7b4edbdc749e74562fc1ebcef9930f (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/109e94c51cf813eb3f69e22556cb990d4eec5ac3 (bp)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/bagder/curl/commit/c877c50e13ad43459de12a4092bd95872e549dfb (bp)"
          }
        ]
      }
    }
  }
}
