{
  "candidate": "CVE-2015-4020",
  "description": "RubyGems 2.0.x before 2.0.17, 2.2.x before 2.2.5, and 2.4.x before 2.4.8 does not validate the hostname when fetching gems or making API requests, which allows remote attackers to redirect requests to arbitrary domains via a crafted DNS SRV record with a domain that is suffixed with the original domain name, aka a \"DNS hijack attack.\" NOTE: this vulnerability exists because to an incomplete fix for CVE-2015-3900.",
  "notes": {
    "tyhicks": "rubygems is for users of ruby1.8. ruby1.9.1 and jruby ship an embedded rubygems."
  },
  "priority": "low",
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4020",
    "https://github.com/rubygems/rubygems/commit/5c7bfb5"
  ],
  "public_date": "2015-08-25 17:59:00 UTC",
  "packages": {
    "devel": {
      "jruby": {
        "name": "jruby",
        "status": "not-affected"
      },
      "libgems-ruby": {
        "name": "libgems-ruby",
        "status": "DNE"
      },
      "ruby1.8": {
        "name": "ruby1.8",
        "status": "DNE"
      },
      "ruby1.9.1": {
        "name": "ruby1.9.1",
        "status": "not-affected"
      },
      "ruby2.1": {
        "name": "ruby2.1",
        "status": "not-affected"
      },
      "ruby2.2": {
        "name": "ruby2.2",
        "status": "not-affected"
      },
      "rubygems": {
        "name": "rubygems",
        "status": "DNE"
      }
    },
    "precise": {
      "jruby": {
        "name": "jruby",
        "status": "not-affected"
      },
      "libgems-ruby": {
        "name": "libgems-ruby",
        "status": "DNE"
      },
      "ruby1.8": {
        "name": "ruby1.8",
        "status": "not-affected"
      },
      "ruby1.9.1": {
        "name": "ruby1.9.1",
        "status": "not-affected"
      },
      "ruby2.1": {
        "name": "ruby2.1",
        "status": "DNE"
      },
      "ruby2.2": {
        "name": "ruby2.2",
        "status": "DNE"
      },
      "rubygems": {
        "name": "rubygems",
        "status": "not-affected"
      }
    },
    "trusty": {
      "jruby": {
        "name": "jruby",
        "status": "not-affected"
      },
      "libgems-ruby": {
        "name": "libgems-ruby",
        "status": "DNE"
      },
      "ruby1.8": {
        "name": "ruby1.8",
        "status": "DNE"
      },
      "ruby1.9.1": {
        "name": "ruby1.9.1",
        "status": "not-affected"
      },
      "ruby2.1": {
        "name": "ruby2.1",
        "status": "DNE"
      },
      "ruby2.2": {
        "name": "ruby2.2",
        "status": "DNE"
      },
      "rubygems": {
        "name": "rubygems",
        "status": "DNE"
      }
    },
    "trusty/esm": {
      "jruby": {
        "name": "jruby",
        "status": "not-affected"
      },
      "libgems-ruby": {
        "name": "libgems-ruby",
        "status": "DNE"
      },
      "ruby1.8": {
        "name": "ruby1.8",
        "status": "DNE"
      },
      "ruby1.9.1": {
        "name": "ruby1.9.1",
        "status": "DNE",
        "note": "trusty was not-affected"
      },
      "ruby2.1": {
        "name": "ruby2.1",
        "status": "DNE"
      },
      "ruby2.2": {
        "name": "ruby2.2",
        "status": "DNE"
      },
      "rubygems": {
        "name": "rubygems",
        "status": "DNE"
      }
    },
    "upstream": {
      "jruby": {
        "name": "jruby",
        "status": "not-affected"
      },
      "libgems-ruby": {
        "name": "libgems-ruby",
        "status": "not-affected"
      },
      "ruby1.8": {
        "name": "ruby1.8",
        "status": "not-affected"
      },
      "ruby1.9.1": {
        "name": "ruby1.9.1",
        "status": "not-affected"
      },
      "ruby2.1": {
        "name": "ruby2.1",
        "status": "not-affected"
      },
      "ruby2.2": {
        "name": "ruby2.2",
        "status": "not-affected"
      },
      "rubygems": {
        "name": "rubygems",
        "status": "not-affected"
      }
    },
    "utopic": {
      "jruby": {
        "name": "jruby",
        "status": "not-affected"
      },
      "libgems-ruby": {
        "name": "libgems-ruby",
        "status": "DNE"
      },
      "ruby1.8": {
        "name": "ruby1.8",
        "status": "DNE"
      },
      "ruby1.9.1": {
        "name": "ruby1.9.1",
        "status": "not-affected"
      },
      "ruby2.1": {
        "name": "ruby2.1",
        "status": "not-affected"
      },
      "ruby2.2": {
        "name": "ruby2.2",
        "status": "DNE"
      },
      "rubygems": {
        "name": "rubygems",
        "status": "DNE"
      }
    },
    "vivid": {
      "jruby": {
        "name": "jruby",
        "status": "not-affected"
      },
      "libgems-ruby": {
        "name": "libgems-ruby",
        "status": "DNE"
      },
      "ruby1.8": {
        "name": "ruby1.8",
        "status": "DNE"
      },
      "ruby1.9.1": {
        "name": "ruby1.9.1",
        "status": "not-affected"
      },
      "ruby2.1": {
        "name": "ruby2.1",
        "status": "not-affected"
      },
      "ruby2.2": {
        "name": "ruby2.2",
        "status": "DNE"
      },
      "rubygems": {
        "name": "rubygems",
        "status": "DNE"
      }
    }
  }
}
