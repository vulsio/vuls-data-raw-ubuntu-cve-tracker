{
	"candidate": "CVE-2024-24806",
	"description": "libuv is a multi-platform support library with a focus on asynchronous I/O. The `uv_getaddrinfo` function in `src/unix/getaddrinfo.c` (and its windows counterpart `src/win/getaddrinfo.c`), truncates hostnames to 256 characters before calling `getaddrinfo`. This behavior can be exploited to create addresses like `0x00007f000001`, which are considered valid by `getaddrinfo` and could allow an attacker to craft payloads that resolve to unintended IP addresses, bypassing developer checks. The vulnerability arises due to how the `hostname_ascii` variable (with a length of 256 bytes) is handled in `uv_getaddrinfo` and subsequently in `uv__idna_toascii`. When the hostname exceeds 256 characters, it gets truncated without a terminating null byte. As a result attackers may be able to access internal APIs or for websites (similar to MySpace) that allows users to have `username.example.com` pages. Internal services that crawl or cache these user pages can be exposed to SSRF attacks if a malicious user chooses a long vulnerable username. This issue has been addressed in release version 1.48.0. Users are advised to upgrade. There are no known workarounds for this vulnerability.",
	"priority": "medium",
	"bugs": [
		"http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1063484"
	],
	"references": [
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-24806",
		"https://github.com/libuv/libuv/security/advisories/GHSA-f74f-cvh7-c6q6",
		"http://www.openwall.com/lists/oss-security/2024/02/08/2"
	],
	"assigned_to": "mdeslaur",
	"public_date": "2024-02-09",
	"packages": {
		"bionic": {
			"libuv1": {
				"name": "libuv1",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/0f2d7e784a256b54b2385043438848047bc2a629 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/3530bcc30350d4a6ccf35d2f7b33e23292b9de70 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/e0327e1d508b8207c9150b6e582f0adf26213c39 (v1.48.0)"
					}
				]
			}
		},
		"devel": {
			"libuv1": {
				"name": "libuv1",
				"status": "needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/0f2d7e784a256b54b2385043438848047bc2a629 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/3530bcc30350d4a6ccf35d2f7b33e23292b9de70 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/e0327e1d508b8207c9150b6e582f0adf26213c39 (v1.48.0)"
					}
				]
			}
		},
		"esm-apps/xenial": {
			"libuv1": {
				"name": "libuv1",
				"status": "not-affected",
				"note": "code not present",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/0f2d7e784a256b54b2385043438848047bc2a629 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/3530bcc30350d4a6ccf35d2f7b33e23292b9de70 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/e0327e1d508b8207c9150b6e582f0adf26213c39 (v1.48.0)"
					}
				]
			}
		},
		"esm-infra/bionic": {
			"libuv1": {
				"name": "libuv1",
				"status": "not-affected",
				"note": "code not present",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/0f2d7e784a256b54b2385043438848047bc2a629 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/3530bcc30350d4a6ccf35d2f7b33e23292b9de70 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/e0327e1d508b8207c9150b6e582f0adf26213c39 (v1.48.0)"
					}
				]
			}
		},
		"focal": {
			"libuv1": {
				"name": "libuv1",
				"status": "needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/0f2d7e784a256b54b2385043438848047bc2a629 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/3530bcc30350d4a6ccf35d2f7b33e23292b9de70 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/e0327e1d508b8207c9150b6e582f0adf26213c39 (v1.48.0)"
					}
				]
			}
		},
		"jammy": {
			"libuv1": {
				"name": "libuv1",
				"status": "needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/0f2d7e784a256b54b2385043438848047bc2a629 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/3530bcc30350d4a6ccf35d2f7b33e23292b9de70 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/e0327e1d508b8207c9150b6e582f0adf26213c39 (v1.48.0)"
					}
				]
			}
		},
		"mantic": {
			"libuv1": {
				"name": "libuv1",
				"status": "needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/0f2d7e784a256b54b2385043438848047bc2a629 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/3530bcc30350d4a6ccf35d2f7b33e23292b9de70 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/e0327e1d508b8207c9150b6e582f0adf26213c39 (v1.48.0)"
					}
				]
			}
		},
		"trusty": {
			"libuv1": {
				"name": "libuv1",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/0f2d7e784a256b54b2385043438848047bc2a629 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/3530bcc30350d4a6ccf35d2f7b33e23292b9de70 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/e0327e1d508b8207c9150b6e582f0adf26213c39 (v1.48.0)"
					}
				]
			}
		},
		"upstream": {
			"libuv1": {
				"name": "libuv1",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/0f2d7e784a256b54b2385043438848047bc2a629 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/3530bcc30350d4a6ccf35d2f7b33e23292b9de70 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/e0327e1d508b8207c9150b6e582f0adf26213c39 (v1.48.0)"
					}
				]
			}
		},
		"xenial": {
			"libuv1": {
				"name": "libuv1",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/0f2d7e784a256b54b2385043438848047bc2a629 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/3530bcc30350d4a6ccf35d2f7b33e23292b9de70 (v1.48.0)"
					},
					{
						"source": "upstream",
						"text": "https://github.com/libuv/libuv/commit/e0327e1d508b8207c9150b6e582f0adf26213c39 (v1.48.0)"
					}
				]
			}
		}
	}
}
