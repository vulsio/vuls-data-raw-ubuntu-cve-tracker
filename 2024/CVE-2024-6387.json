{
	"candidate": "CVE-2024-6387",
	"description": "A security regression (CVE-2006-5051) was discovered in OpenSSH's server (sshd). There is a race condition which can lead to sshd to handle some signals in an unsafe manner. An unauthenticated, remote attacker may be able to trigger it by failing to authenticate within a set time period.",
	"ubuntu_description": "It was discovered that OpenSSH incorrectly handled signal management. A remote attacker could use this issue to bypass authentication and remotely access systems without proper credentials.",
	"notes": {
		"sbeattie": "introduced in upstream commit 752250caa (\"upstream: revised log infrastructure for OpenSSH\", 2020-10-16) (v8.5p1) essentially a regression of CVE-2006-5051 Because of a quirk of the 24.04/noble patch to allow systemd socket activation, it is believed that that release is not vulnerable to the exploitation approach taken by Qualys. https://git.launchpad.net/ubuntu/+source/openssh/tree/debian/patches/systemd-socket-activation.patch",
		"seth-arnold": "openssh-ssh1 is provided for compatibility with old devices that cannot be upgraded to modern protocols. Thus we may not provide security support for this package if doing so would prevent access to equipment."
	},
	"priority": "high",
	"mitigation": "Set LoginGraceTime to 0 in /etc/ssh/sshd_config. This makes sshd\nvulnerable to a denial of service (the exhaustion of all MaxStartups\nconnections), but it makes it safe from this vulnerability.",
	"bugs": [
		"https://bugzilla.mindrot.org/show_bug.cgi?id=3690",
		"https://bugs.launchpad.net/ubuntu/+source/openssh/+bug/2070497",
		"Potential remote code execution"
	],
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-6387",
		"https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt",
		"https://ubuntu.com/security/notices/USN-6859-1"
	],
	"assigned_to": "mdeslaur",
	"discovered_by": "Qualys Threat Research Unit (TRU)",
	"public_date": "2024-07-01 13:15:00 UTC",
	"public_date_at_usn": "2024-07-01",
	"crd": "2024-07-01",
	"packages": {
		"devel": {
			"openssh": {
				"name": "openssh",
				"status": "released",
				"note": "1:9.6p1-3ubuntu15"
			},
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"esm-apps/bionic": {
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"esm-apps/focal": {
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"esm-apps/jammy": {
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"esm-apps/noble": {
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"esm-infra/bionic": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"esm-infra/xenial": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"fips-updates/bionic": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"fips-updates/focal": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"fips-updates/xenial": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"fips/bionic": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"fips/focal": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"fips/xenial": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"focal": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			},
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"jammy": {
			"openssh": {
				"name": "openssh",
				"status": "released",
				"note": "1:8.9p1-3ubuntu0.10"
			},
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"mantic": {
			"openssh": {
				"name": "openssh",
				"status": "released",
				"note": "1:9.3p1-1ubuntu3.6"
			},
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"noble": {
			"openssh": {
				"name": "openssh",
				"status": "released",
				"note": "1:9.6p1-3ubuntu13.3"
			},
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"trusty/esm": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "introduced in v8.5p1"
			}
		},
		"upstream": {
			"openssh": {
				"name": "openssh",
				"status": "pending",
				"note": "9.8p1"
			},
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "ignored",
				"note": "frozen on openssh 7.5p"
			}
		}
	}
}
