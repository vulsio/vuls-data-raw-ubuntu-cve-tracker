{
	"candidate": "CVE-2024-1724",
	"description": "In snapd versions prior to 2.62, when using AppArmor for enforcement of sandbox permissions, snapd failed to restrict writes to the $HOME/bin path. In Ubuntu, when this path exists, it is automatically added to the users PATH. An attacker who could convince a user to install a malicious snap which used the 'home' plug could use this vulnerability to install arbitrary scripts into the users PATH which may then be run by the user outside of the expected snap sandbox and hence allow them to escape confinement.",
	"notes": {
		"sarnold": "CWE-732 CAPEC-1"
	},
	"priority": "medium",
	"cvss": {
		"ubuntu": " CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L [6.3 MEDIUM]"
	},
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-1724",
		"https://github.com/snapcore/snapd/pull/13689",
		"https://gld.mcphail.uk/posts/explaining-cve-2024-1724/"
	],
	"assigned_to": "alexmurray",
	"discovered_by": "Neil McPhail",
	"public_date": "2024-03-13",
	"crd": "2024-07-01",
	"packages": {
		"bionic": {
			"snapd": {
				"name": "snapd",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6"
					}
				]
			}
		},
		"devel": {
			"snapd": {
				"name": "snapd",
				"status": "released",
				"note": "2.63+24.10",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6"
					}
				]
			}
		},
		"esm-infra/bionic": {
			"snapd": {
				"name": "snapd",
				"status": "needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6"
					}
				]
			}
		},
		"esm-infra/xenial": {
			"snapd": {
				"name": "snapd",
				"status": "needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6"
					}
				]
			}
		},
		"focal": {
			"snapd": {
				"name": "snapd",
				"status": "needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6"
					}
				]
			}
		},
		"jammy": {
			"snapd": {
				"name": "snapd",
				"status": "needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6"
					}
				]
			}
		},
		"mantic": {
			"snapd": {
				"name": "snapd",
				"status": "ignored",
				"note": "end of life, was needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6"
					}
				]
			}
		},
		"noble": {
			"snapd": {
				"name": "snapd",
				"status": "released",
				"note": "2.62+24.04build1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6"
					}
				]
			}
		},
		"snap": {
			"snapd": {
				"name": "snapd",
				"status": "released",
				"note": "2.62",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6"
					}
				]
			}
		},
		"trusty": {
			"snapd": {
				"name": "snapd",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6"
					}
				]
			}
		},
		"upstream": {
			"snapd": {
				"name": "snapd",
				"status": "released",
				"note": "2.62",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6"
					}
				]
			}
		},
		"xenial": {
			"snapd": {
				"name": "snapd",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/snapcore/snapd/commit/aa191f97713de8dc3ce3ac818539f0b976eb8ef6"
					}
				]
			}
		}
	}
}
