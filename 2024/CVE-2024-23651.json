{
	"candidate": "CVE-2024-23651",
	"description": "BuildKit is a toolkit for converting source code to build artifacts in an efficient, expressive and repeatable manner. Two malicious build steps running in parallel sharing the same cache mounts with subpaths could cause a race condition that can lead to files from the host system being accessible to the build container. The issue has been fixed in v0.12.5. Workarounds include, avoiding using BuildKit frontend from an untrusted source or building an untrusted Dockerfile containing cache mounts with --mount=type=cache,source=... options.",
	"notes": {
		"alexmurray": "Traditionally the docker.io source package contained both the library and docker application. However, in releases that contain the docker.io-app source package, the docker.io source package contains only the library whilst the docker application itself is contained in the docker.io-app package.",
		"sbeattie": "docker packages contain an embedded copy of github:moby/buildkit"
	},
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N [7.4 HIGH]"
	},
	"references": [
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-23651",
		"https://github.com/moby/buildkit/security/advisories/GHSA-m3r6-h7wv-7xxv",
		"https://github.com/moby/buildkit/pull/4604",
		"https://github.com/moby/buildkit/releases/tag/v0.12.5",
		"https://www.openwall.com/lists/oss-security/2019/05/28/1"
	],
	"assigned_to": "0xnishit",
	"public_date": "2024-01-31 22:15:00 UTC",
	"packages": {
		"bionic": {
			"docker.io": {
				"name": "docker.io",
				"status": "ignored",
				"note": "end of standard support"
			},
			"docker.io-app": {
				"name": "docker.io-app",
				"status": "DNE"
			}
		},
		"devel": {
			"docker.io": {
				"name": "docker.io",
				"status": "needs-triage"
			},
			"docker.io-app": {
				"name": "docker.io-app",
				"status": "needs-triage"
			}
		},
		"esm-apps/bionic": {
			"docker.io": {
				"name": "docker.io",
				"status": "needs-triage"
			}
		},
		"esm-apps/focal": {
			"docker.io": {
				"name": "docker.io",
				"status": "needs-triage"
			}
		},
		"esm-apps/jammy": {
			"docker.io": {
				"name": "docker.io",
				"status": "needs-triage"
			}
		},
		"esm-apps/xenial": {
			"docker.io": {
				"name": "docker.io",
				"status": "needs-triage"
			}
		},
		"focal": {
			"docker.io": {
				"name": "docker.io",
				"status": "needs-triage"
			},
			"docker.io-app": {
				"name": "docker.io-app",
				"status": "needs-triage"
			}
		},
		"jammy": {
			"docker.io": {
				"name": "docker.io",
				"status": "needs-triage"
			},
			"docker.io-app": {
				"name": "docker.io-app",
				"status": "needs-triage"
			}
		},
		"mantic": {
			"docker.io": {
				"name": "docker.io",
				"status": "needs-triage"
			},
			"docker.io-app": {
				"name": "docker.io-app",
				"status": "needs-triage"
			}
		},
		"trusty": {
			"docker.io": {
				"name": "docker.io",
				"status": "ignored",
				"note": "end of standard support"
			},
			"docker.io-app": {
				"name": "docker.io-app",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"upstream": {
			"docker.io": {
				"name": "docker.io",
				"status": "needs-triage"
			},
			"docker.io-app": {
				"name": "docker.io-app",
				"status": "needs-triage"
			}
		},
		"xenial": {
			"docker.io": {
				"name": "docker.io",
				"status": "ignored",
				"note": "end of standard support"
			},
			"docker.io-app": {
				"name": "docker.io-app",
				"status": "DNE"
			}
		}
	}
}
