{
	"candidate": "CVE-2024-6409",
	"description": "Possible race condition in cleanup_exit() in openssh's privsep child, for openssh 8.7p1 and 8.8p1. `cleanup_exit()` gets called from the privsep child, which appears to call the non-asynchronous safe `do_cleanup()`, but possibly only post authentication (`the_authctxt != NULL`). Furthermore Red Hat 9 carries a specific patch that calls additional potentially unsafe cleanup functions.",
	"notes": {
		"sbeattie": "Potential issue appears to have only been present in openssh 8.7p1 and 8.8p1, versions not present in currently supported Ubuntu releases.",
		"seth-arnold": "openssh-ssh1 is provided for compatibility with old devices that cannot be upgraded to modern protocols. Thus we may not provide security support for this package if doing so would prevent access to equipment."
	},
	"priority": "medium",
	"references": [
		"https://www.cve.org/CVERecord?id=CVE-2024-6409"
	],
	"discovered_by": "Solar Designer",
	"public_date": "2024-07-08",
	"crd": "2024-07-08",
	"packages": {
		"devel": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			},
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"esm-apps/bionic": {
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"esm-apps/focal": {
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"esm-apps/jammy": {
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"esm-apps/noble": {
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"esm-infra-legacy/trusty": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"esm-infra/bionic": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"esm-infra/xenial": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"fips-updates/bionic": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"fips-updates/focal": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"fips-updates/xenial": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"fips/bionic": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"fips/focal": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"fips/xenial": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"focal": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			},
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"jammy": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			},
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"mantic": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			},
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"noble": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			},
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"trusty/esm": {
			"openssh": {
				"name": "openssh",
				"status": "not-affected",
				"note": "code not present"
			}
		},
		"upstream": {
			"openssh": {
				"name": "openssh",
				"status": "needs-triage"
			},
			"openssh-ssh1": {
				"name": "openssh-ssh1",
				"status": "ignored",
				"note": "frozen on openssh 7.5p"
			}
		}
	}
}
