{
  "candidate": "CVE-2009-0692",
  "description": "Stack-based buffer overflow in the script_write_params method in client/dhclient.c in ISC DHCP dhclient 4.1 before 4.1.0p1, 4.0 before 4.0.1p1, 3.1 before 3.1.2p1, 3.0, and 2.0 allows remote DHCP servers to execute arbitrary code via a crafted subnet-mask option.",
  "notes": {
    "[DHO_SUBNET_MASK].len < sizeof lease -": "address.iabuf. address.iabuf is the same size as netmask.iabuf. Furthermore, subnet_number() and broadcast_addr() (further below) properly check/use the length of netmask",
    "jdstrand": "requires connecting to a malicious dhcp v4 server. Assigning high priority due to widespread use and frequency of roaming users connecting to untrusted dhcp servers CERT VU#410676 this is only a DoS on Intrepid and later due to FORTIFY_SOURCE and can be considered 'low'. Jaunty also has an AppArmor profile that fully mitigates arbitrary code execution. dhcp v2 is not affected because it checks that lease -> options"
  },
  "priority": "high",
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0692",
    "https://ubuntu.com/security/notices/USN-803-1",
    "https://www.isc.org/node/468",
    "https://ubuntu.com/security/notices/USN-803-2"
  ],
  "assigned_to": "jdstrand",
  "discovered_by": "Mandriva",
  "public_date": "2009-07-14 20:30:00 UTC",
  "public_date_at_usn": "2009-07-14",
  "packages": {
    "dapper": {
      "dhcp": {
        "name": "dhcp",
        "status": "not-affected"
      },
      "dhcp3": {
        "name": "dhcp3",
        "status": "released",
        "note": "3.0.3-6ubuntu7.1"
      }
    },
    "devel": {
      "dhcp": {
        "name": "dhcp",
        "status": "DNE"
      },
      "dhcp3": {
        "name": "dhcp3",
        "status": "not-affected",
        "note": "3.1.3-1ubuntu3"
      }
    },
    "hardy": {
      "dhcp": {
        "name": "dhcp",
        "status": "DNE"
      },
      "dhcp3": {
        "name": "dhcp3",
        "status": "released",
        "note": "3.0.6.dfsg-1ubuntu9.1"
      }
    },
    "intrepid": {
      "dhcp": {
        "name": "dhcp",
        "status": "DNE"
      },
      "dhcp3": {
        "name": "dhcp3",
        "status": "released",
        "note": "3.1.1-1ubuntu2.2",
        "priority": "low",
        "tags": [
          "fortify-source"
        ]
      }
    },
    "jaunty": {
      "dhcp": {
        "name": "dhcp",
        "status": "DNE"
      },
      "dhcp3": {
        "name": "dhcp3",
        "status": "released",
        "note": "3.1.1-5ubuntu8.2",
        "priority": "low",
        "tags": [
          "fortify-source apparmor"
        ]
      }
    },
    "karmic": {
      "dhcp3": {
        "name": "dhcp3",
        "status": "released",
        "note": "3.1.2-1ubuntu7.1",
        "priority": "low",
        "tags": [
          "fortify-source apparmor"
        ]
      }
    },
    "upstream": {
      "dhcp": {
        "name": "dhcp",
        "status": "needs-triage"
      },
      "dhcp3": {
        "name": "dhcp3",
        "status": "not-affected",
        "note": "3.1.2p1"
      }
    }
  }
}
