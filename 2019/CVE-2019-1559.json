{
	"candidate": "CVE-2019-1559",
	"description": "If an application encounters a fatal protocol error and then calls SSL_shutdown() twice (once to send a close_notify, and once to receive one) then OpenSSL can respond differently to the calling application if a 0 byte record is received with invalid padding compared to if a 0 byte record is received with an invalid MAC. If the application then behaves differently based on that in a way that is detectable to the remote peer, then this amounts to a padding oracle that could be used to decrypt data. In order for this to be exploitable \"non-stitched\" ciphersuites must be in use. Stitched ciphersuites are optimised implementations of certain commonly used ciphersuites. Also the application must call SSL_shutdown() twice even if a protocol error has occurred (applications should not do this but some do anyway). Fixed in OpenSSL 1.0.2r (Affected 1.0.2-1.0.2q).",
	"notes": {
		"mdeslaur": "doesn't affect 1.1.x  this fix is a workaround for applications that call SSL_shutdown() twice even if a protocol error has occurred  upstream fix uses error handling mechanism introduced in 1.0.2, which isn't available in 1.0.1f. While we are unlikely to fix this issue in Ubuntu 14.04 LTS, marking as deferred for now in case the vulnerable applications are identified."
	},
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N [5.9 MEDIUM]"
	},
	"references": [
		"https://www.openssl.org/news/secadv/20190226.txt",
		"https://github.com/RUB-NDS/TLS-Padding-Oracles",
		"https://ubuntu.com/security/notices/USN-3899-1",
		"https://ubuntu.com/security/notices/USN-4376-2",
		"https://www.cve.org/CVERecord?id=CVE-2019-1559"
	],
	"discovered_by": "Juraj Somorovsky, Robert Merget and Nimrod Aviram",
	"public_date": "2019-02-27 23:29:00 UTC",
	"public_date_at_usn": "2019-02-26",
	"packages": {
		"bionic": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl1.0"
			},
			"openssl": {
				"name": "openssl",
				"status": "not-affected",
				"note": "1.1.0g-2ubuntu4.3",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl098": {
				"name": "openssl098",
				"status": "DNE"
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "released",
				"note": "1.0.2n-1ubuntu5.3"
			}
		},
		"cosmic": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl1.0"
			},
			"openssl": {
				"name": "openssl",
				"status": "not-affected",
				"note": "1.1.1-1ubuntu2.1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl098": {
				"name": "openssl098",
				"status": "DNE"
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "released",
				"note": "1.0.2n-1ubuntu6.2"
			}
		},
		"devel": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl1.1"
			},
			"openssl": {
				"name": "openssl",
				"status": "not-affected",
				"note": "1.1.1a-1ubuntu2",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl098": {
				"name": "openssl098",
				"status": "DNE"
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "DNE"
			}
		},
		"disco": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl1.1"
			},
			"openssl": {
				"name": "openssl",
				"status": "not-affected",
				"note": "1.1.1a-1ubuntu2",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl098": {
				"name": "openssl098",
				"status": "DNE"
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "DNE"
			}
		},
		"eoan": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl1.1"
			},
			"openssl": {
				"name": "openssl",
				"status": "not-affected",
				"note": "1.1.1a-1ubuntu2",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl098": {
				"name": "openssl098",
				"status": "DNE"
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "DNE"
			}
		},
		"esm-apps/bionic": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl1.0"
			}
		},
		"esm-apps/focal": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl1.1"
			}
		},
		"esm-apps/xenial": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl"
			}
		},
		"esm-infra-legacy/trusty": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl"
			},
			"openssl": {
				"name": "openssl",
				"status": "released",
				"note": "1.0.1f-1ubuntu2.27+esm1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl098": {
				"name": "openssl098",
				"status": "DNE",
				"note": "trusty/esm was DNE [trusty was needs-triage]"
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "DNE"
			}
		},
		"esm-infra/bionic": {
			"openssl": {
				"name": "openssl",
				"status": "not-affected",
				"note": "1.1.0g-2ubuntu4.3",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "not-affected",
				"note": "1.0.2n-1ubuntu5.3"
			}
		},
		"esm-infra/xenial": {
			"openssl": {
				"name": "openssl",
				"status": "not-affected",
				"note": "1.0.2g-1ubuntu4.15",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			}
		},
		"focal": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl1.1"
			},
			"openssl": {
				"name": "openssl",
				"status": "not-affected",
				"note": "1.1.1a-1ubuntu2",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl098": {
				"name": "openssl098",
				"status": "DNE"
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "DNE"
			}
		},
		"precise/esm": {
			"nodejs": {
				"name": "nodejs",
				"status": "DNE"
			},
			"openssl": {
				"name": "openssl",
				"status": "not-affected",
				"note": "1.0.1-4ubuntu5.44",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl098": {
				"name": "openssl098",
				"status": "DNE"
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "DNE"
			}
		},
		"trusty": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl"
			},
			"openssl": {
				"name": "openssl",
				"status": "ignored",
				"note": "end of standard support",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl098": {
				"name": "openssl098",
				"status": "ignored",
				"note": "end of standard support"
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "DNE"
			}
		},
		"trusty/esm": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl"
			},
			"openssl": {
				"name": "openssl",
				"status": "released",
				"note": "1.0.1f-1ubuntu2.27+esm1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl098": {
				"name": "openssl098",
				"status": "DNE",
				"note": "trusty was needs-triage"
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "DNE"
			}
		},
		"upstream": {
			"nodejs": {
				"name": "nodejs",
				"status": "needs-triage"
			},
			"openssl": {
				"name": "openssl",
				"status": "needs-triage",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl098": {
				"name": "openssl098",
				"status": "needs-triage"
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "needs-triage"
			}
		},
		"xenial": {
			"nodejs": {
				"name": "nodejs",
				"status": "not-affected",
				"note": "uses system openssl"
			},
			"openssl": {
				"name": "openssl",
				"status": "released",
				"note": "1.0.2g-1ubuntu4.15",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/openssl/openssl/commit/e9bbefbf0f24c57645e7ad6a5a71ae649d18ac8e"
					}
				]
			},
			"openssl098": {
				"name": "openssl098",
				"status": "DNE"
			},
			"openssl1.0": {
				"name": "openssl1.0",
				"status": "DNE"
			}
		}
	}
}
