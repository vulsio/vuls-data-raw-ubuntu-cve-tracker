{
	"candidate": "CVE-2017-12982",
	"description": "The bmp_read_info_header function in bin/jp2/convertbmp.c in OpenJPEG 2.2.0 does not reject headers with a zero biBitCount, which allows remote attackers to cause a denial of service (memory allocation failure) in the opj_image_create function in lib/openjp2/image.c, related to the opj_aligned_alloc_n function in opj_malloc.c.",
	"ubuntu_description": "It was discovered that OpenJPEG incorrectly handled certain image files. A remote attacker could possibly use this issue to cause a denial of service.",
	"notes": {
		"ccdm94": "openjpeg is not affected by this issue since the variable which was not checked for value 0 is checked in the 1.x versions. The code was refactored in versions 2.x, and this check was removed, causing the vulnerability. In versions 1.x, variable Info_h.biBitCount is checked for values 24 and 8, and if not equal to one of them, the converter returns an error message instead of processing the image file given as input. In versions 1.x of openjpeg, the function that contains similar code to the vulnerable one in versions 2.x can be found in file convert.c. The reproducer does not cause the memory allocation failure error in versions 1.x."
	},
	"priority": "low",
	"cvss": {
		"nvd": " CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H [5.5 MEDIUM]"
	},
	"bugs": [
		"https://github.com/uclouvain/openjpeg/issues/983"
	],
	"references": [
		"https://blogs.gentoo.org/ago/2017/08/14/openjpeg-memory-allocation-failure-in-opj_aligned_alloc_n-opj_malloc-c/",
		"https://ubuntu.com/security/notices/USN-4782-1",
		"https://www.cve.org/CVERecord?id=CVE-2017-12982"
	],
	"discovered_by": "Agostino Sarubbo",
	"public_date": "2017-08-21 07:29:00 UTC",
	"public_date_at_usn": "2017-08-21 07:29:00 UTC",
	"packages": {
		"artful": {
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "ignored",
				"note": "end of life",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"bionic": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "not-affected",
				"note": "code not compiled"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "released",
				"note": "2.3.0-1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"cosmic": {
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "ignored",
				"note": "end of life",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"devel": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "not-affected",
				"note": "uses system openjpeg2"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "not-affected",
				"note": "2.3.0-1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"disco": {
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "not-affected",
				"note": "2.3.0-1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"eoan": {
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "not-affected",
				"note": "2.3.0-1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"esm-apps/bionic": {
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "released",
				"note": "2.3.0-1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"esm-apps/xenial": {
			"openjpeg": {
				"name": "openjpeg",
				"status": "not-affected",
				"note": "code not present",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "released",
				"note": "2.1.2-1.1+deb9u6ubuntu0.1~esm1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"esm-infra/bionic": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "not-affected",
				"note": "code not compiled"
			}
		},
		"esm-infra/xenial": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "not-affected",
				"note": "code not compiled"
			}
		},
		"focal": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "not-affected",
				"note": "uses system openjpeg2"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "not-affected",
				"note": "2.3.0-1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"groovy": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "not-affected",
				"note": "uses system openjpeg2"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "not-affected",
				"note": "2.3.0-1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"hirsute": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "not-affected",
				"note": "uses system openjpeg2"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "not-affected",
				"note": "2.3.0-1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"impish": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "not-affected",
				"note": "uses system openjpeg2"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "not-affected",
				"note": "2.3.0-1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"jammy": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "not-affected",
				"note": "uses system openjpeg2"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "not-affected",
				"note": "2.3.0-1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"kinetic": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "not-affected",
				"note": "uses system openjpeg2"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "not-affected",
				"note": "2.3.0-1",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"precise/esm": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "DNE"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"trusty": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "ignored",
				"note": "end of standard support"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "not-affected",
				"note": "code not present",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"trusty/esm": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "DNE"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "not-affected",
				"note": "code not present",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"upstream": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "needs-triage"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "released",
				"note": "2.3.0",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "released",
				"note": "2.3.0",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"vivid/ubuntu-core": {
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"xenial": {
			"ghostscript": {
				"name": "ghostscript",
				"status": "not-affected",
				"note": "code not compiled"
			},
			"openjpeg": {
				"name": "openjpeg",
				"status": "ignored",
				"note": "end of standard support, was not-affected",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			},
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "ignored",
				"note": "end of standard support, was needed",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		},
		"zesty": {
			"openjpeg2": {
				"name": "openjpeg2",
				"status": "ignored",
				"note": "end of life",
				"patches": [
					{
						"source": "upstream",
						"text": "https://github.com/uclouvain/openjpeg/commit/baf0c1ad4572daa89caa3b12985bdd93530f0dd7"
					}
				]
			}
		}
	}
}
