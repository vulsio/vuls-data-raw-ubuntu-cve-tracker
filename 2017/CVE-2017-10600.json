{
  "candidate": "CVE-2017-10600",
  "description": "ubuntu-image 1.0 before 2017-07-07, when invoked as non-root, creates files in the resulting image with the uid of the invoking user. When the resulting image is booted, a local attacker with the same uid as the image creator has unintended access to cloud-init and snapd directories.",
  "ubuntu_description": "ubuntu-image 1.0 when invoked as non-root on systems with e2fsprogs >= 1.43 creates file permissions in the resulting image with the UID of the invoking user. When the resulting image is booted, a local attacker with the same UID as the image creator can alter installed snap packages and signatures to downgrade or potentially replace snap packages.",
  "notes": {
    "jdstrand": "this issue only affects Ubuntu Core and not snapd on Ubuntu classic while snapd is not affected, an updated snapd will attempt to correct permissions on refresh. Because this only affects Ubuntu Core, that update will happen via the snap store and not included as a separate security update for the Ubuntu archive. Ubuntu 16.04 LTS has e2fsprogs 1.42.13"
  },
  "priority": "high",
  "cvss": {
    "nvd": " CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L [5.9 MEDIUM]"
  },
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-10600",
    "https://github.com/CanonicalLtd/ubuntu-image/pull/135",
    "https://forum.snapcraft.io/t/ownership-bug-in-ubuntu-image/1285/1"
  ],
  "assigned_to": "jdstrand",
  "public_date": "2017-07-11 17:29:00 UTC",
  "packages": {
    "devel": {
      "ubuntu-image": {
        "name": "ubuntu-image",
        "status": "released",
        "note": "1.1+17.10ubuntu1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/CanonicalLtd/ubuntu-image/pull/135"
          }
        ]
      }
    },
    "esm-infra/xenial": {
      "ubuntu-image": {
        "name": "ubuntu-image",
        "status": "ignored",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/CanonicalLtd/ubuntu-image/pull/135"
          }
        ]
      }
    },
    "precise/esm": {
      "ubuntu-image": {
        "name": "ubuntu-image",
        "status": "DNE",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/CanonicalLtd/ubuntu-image/pull/135"
          }
        ]
      }
    },
    "trusty": {
      "ubuntu-image": {
        "name": "ubuntu-image",
        "status": "DNE",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/CanonicalLtd/ubuntu-image/pull/135"
          }
        ]
      }
    },
    "trusty/esm": {
      "ubuntu-image": {
        "name": "ubuntu-image",
        "status": "DNE",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/CanonicalLtd/ubuntu-image/pull/135"
          }
        ]
      }
    },
    "upstream": {
      "ubuntu-image": {
        "name": "ubuntu-image",
        "status": "released",
        "note": "1.1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/CanonicalLtd/ubuntu-image/pull/135"
          }
        ]
      }
    },
    "vivid/ubuntu-core": {
      "ubuntu-image": {
        "name": "ubuntu-image",
        "status": "DNE",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/CanonicalLtd/ubuntu-image/pull/135"
          }
        ]
      }
    },
    "xenial": {
      "ubuntu-image": {
        "name": "ubuntu-image",
        "status": "ignored",
        "priority": "negligible",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/CanonicalLtd/ubuntu-image/pull/135"
          }
        ]
      }
    },
    "yakkety": {
      "ubuntu-image": {
        "name": "ubuntu-image",
        "status": "released",
        "note": "1.0+16.10ubuntu1.1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/CanonicalLtd/ubuntu-image/pull/135"
          }
        ]
      }
    },
    "zesty": {
      "ubuntu-image": {
        "name": "ubuntu-image",
        "status": "released",
        "note": "1.0+17.04ubuntu1.1",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/CanonicalLtd/ubuntu-image/pull/135"
          }
        ]
      }
    }
  }
}
