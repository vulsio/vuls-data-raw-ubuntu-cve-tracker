{
	"candidate": "CVE-2017-12151",
	"description": "A flaw was found in the way samba client before samba 4.4.16, samba 4.5.14 and samba 4.6.8 used encryption with the max protocol set as SMB3. The connection could lose the requirement for signing and encrypting to any DFS redirects, allowing an attacker to read or alter the contents of the connection via a man-in-the-middle attack.",
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N [7.4 HIGH]"
	},
	"bugs": [
		"https://bugzilla.samba.org/show_bug.cgi?id=12996"
	],
	"references": [
		"https://www.samba.org/samba/security/CVE-2017-12151.html",
		"https://ubuntu.com/security/notices/USN-3426-1",
		"https://www.cve.org/CVERecord?id=CVE-2017-12151"
	],
	"assigned_to": "mdeslaur",
	"discovered_by": "Stefan Metzmacher",
	"public_date": "2018-07-27 12:29:00 UTC",
	"public_date_at_usn": "2017-09-20",
	"crd": "2017-09-20",
	"packages": {
		"devel": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.6.7+dfsg-1ubuntu3",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=17019aa27f612f4ccc7131d40c54b26864fef444 (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=50f649e7d0b27bcd7eaab7d8223ef9ccd99782dc (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=282a1d122f9861b0521fa5a389ad467f8da93bd1 (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=157f2a703bcaca9495d50cbd4d48c24b1ceed80d (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=3157ccef61bd0698207054daf060cf2986d1d110 (4.6)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=105cc438c6cb3dc741e861855e3fa5a94a156ff0 (4.6)"
					}
				]
			}
		},
		"esm-infra-legacy/trusty": {
			"samba": {
				"name": "samba",
				"status": "not-affected",
				"note": "2:4.3.11+dfsg-0ubuntu0.14.04.12",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=17019aa27f612f4ccc7131d40c54b26864fef444 (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=50f649e7d0b27bcd7eaab7d8223ef9ccd99782dc (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=282a1d122f9861b0521fa5a389ad467f8da93bd1 (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=157f2a703bcaca9495d50cbd4d48c24b1ceed80d (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=3157ccef61bd0698207054daf060cf2986d1d110 (4.6)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=105cc438c6cb3dc741e861855e3fa5a94a156ff0 (4.6)"
					}
				]
			}
		},
		"esm-infra/xenial": {
			"samba": {
				"name": "samba",
				"status": "not-affected",
				"note": "2:4.3.11+dfsg-0ubuntu0.16.04.11",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=17019aa27f612f4ccc7131d40c54b26864fef444 (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=50f649e7d0b27bcd7eaab7d8223ef9ccd99782dc (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=282a1d122f9861b0521fa5a389ad467f8da93bd1 (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=157f2a703bcaca9495d50cbd4d48c24b1ceed80d (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=3157ccef61bd0698207054daf060cf2986d1d110 (4.6)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=105cc438c6cb3dc741e861855e3fa5a94a156ff0 (4.6)"
					}
				]
			}
		},
		"precise/esm": {
			"samba": {
				"name": "samba",
				"status": "not-affected",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=17019aa27f612f4ccc7131d40c54b26864fef444 (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=50f649e7d0b27bcd7eaab7d8223ef9ccd99782dc (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=282a1d122f9861b0521fa5a389ad467f8da93bd1 (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=157f2a703bcaca9495d50cbd4d48c24b1ceed80d (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=3157ccef61bd0698207054daf060cf2986d1d110 (4.6)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=105cc438c6cb3dc741e861855e3fa5a94a156ff0 (4.6)"
					}
				]
			}
		},
		"trusty": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.3.11+dfsg-0ubuntu0.14.04.12",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=17019aa27f612f4ccc7131d40c54b26864fef444 (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=50f649e7d0b27bcd7eaab7d8223ef9ccd99782dc (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=282a1d122f9861b0521fa5a389ad467f8da93bd1 (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=157f2a703bcaca9495d50cbd4d48c24b1ceed80d (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=3157ccef61bd0698207054daf060cf2986d1d110 (4.6)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=105cc438c6cb3dc741e861855e3fa5a94a156ff0 (4.6)"
					}
				]
			}
		},
		"trusty/esm": {
			"samba": {
				"name": "samba",
				"status": "not-affected",
				"note": "2:4.3.11+dfsg-0ubuntu0.14.04.12",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=17019aa27f612f4ccc7131d40c54b26864fef444 (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=50f649e7d0b27bcd7eaab7d8223ef9ccd99782dc (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=282a1d122f9861b0521fa5a389ad467f8da93bd1 (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=157f2a703bcaca9495d50cbd4d48c24b1ceed80d (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=3157ccef61bd0698207054daf060cf2986d1d110 (4.6)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=105cc438c6cb3dc741e861855e3fa5a94a156ff0 (4.6)"
					}
				]
			}
		},
		"upstream": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "4.6.8,4.5.14,4.4.16",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=17019aa27f612f4ccc7131d40c54b26864fef444 (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=50f649e7d0b27bcd7eaab7d8223ef9ccd99782dc (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=282a1d122f9861b0521fa5a389ad467f8da93bd1 (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=157f2a703bcaca9495d50cbd4d48c24b1ceed80d (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=3157ccef61bd0698207054daf060cf2986d1d110 (4.6)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=105cc438c6cb3dc741e861855e3fa5a94a156ff0 (4.6)"
					}
				]
			}
		},
		"vivid/ubuntu-core": {
			"samba": {
				"name": "samba",
				"status": "DNE",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=17019aa27f612f4ccc7131d40c54b26864fef444 (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=50f649e7d0b27bcd7eaab7d8223ef9ccd99782dc (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=282a1d122f9861b0521fa5a389ad467f8da93bd1 (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=157f2a703bcaca9495d50cbd4d48c24b1ceed80d (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=3157ccef61bd0698207054daf060cf2986d1d110 (4.6)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=105cc438c6cb3dc741e861855e3fa5a94a156ff0 (4.6)"
					}
				]
			}
		},
		"xenial": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.3.11+dfsg-0ubuntu0.16.04.11",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=17019aa27f612f4ccc7131d40c54b26864fef444 (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=50f649e7d0b27bcd7eaab7d8223ef9ccd99782dc (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=282a1d122f9861b0521fa5a389ad467f8da93bd1 (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=157f2a703bcaca9495d50cbd4d48c24b1ceed80d (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=3157ccef61bd0698207054daf060cf2986d1d110 (4.6)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=105cc438c6cb3dc741e861855e3fa5a94a156ff0 (4.6)"
					}
				]
			}
		},
		"zesty": {
			"samba": {
				"name": "samba",
				"status": "released",
				"note": "2:4.5.8+dfsg-0ubuntu0.17.04.7",
				"patches": [
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=17019aa27f612f4ccc7131d40c54b26864fef444 (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=50f649e7d0b27bcd7eaab7d8223ef9ccd99782dc (4.4)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=282a1d122f9861b0521fa5a389ad467f8da93bd1 (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=157f2a703bcaca9495d50cbd4d48c24b1ceed80d (4.5)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=3157ccef61bd0698207054daf060cf2986d1d110 (4.6)"
					},
					{
						"source": "upstream",
						"text": "https://git.samba.org/?p=samba.git;a=commit;h=105cc438c6cb3dc741e861855e3fa5a94a156ff0 (4.6)"
					}
				]
			}
		}
	}
}
