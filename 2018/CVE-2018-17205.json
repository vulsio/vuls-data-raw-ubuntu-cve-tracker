{
  "candidate": "CVE-2018-17205",
  "description": "An issue was discovered in Open vSwitch (OvS) 2.7.x through 2.7.6, affecting ofproto_rule_insert__ in ofproto/ofproto.c. During bundle commit, flows that are added in a bundle are applied to ofproto in order. If a flow cannot be added (e.g., the flow action is a go-to for a group id that does not exist), OvS tries to revert back all previous flows that were successfully applied from the same bundle. This is possible since OvS maintains list of old flows that were replaced by flows from the bundle. While reinserting old flows, OvS has an assertion failure due to a check on rule state != RULE_INITIALIZED. This would work for new flows, but for an old flow the rule state is RULE_REMOVED. The assertion failure causes an OvS crash.",
  "priority": "medium",
  "cvss": {
    "nvd": " CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H [7.5 HIGH]"
  },
  "references": [
    "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-17205",
    "https://ubuntu.com/security/notices/USN-3873-1"
  ],
  "assigned_to": "mdeslaur",
  "public_date": "2018-09-19 16:29:00 UTC",
  "public_date_at_usn": "2018-09-19",
  "packages": {
    "bionic": {
      "openvswitch": {
        "name": "openvswitch",
        "status": "released",
        "note": "2.9.2-0ubuntu0.18.04.3",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/9a0ac025de9303334688ff08f01fc08604d2f624 (master)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/638d406e3b647359f3d82189d7a6ee56b4a54928 (branch-2.8)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/0befd1f3745055c32940f5faf9559be6a14395e6 (branch-2.7)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/24bf63b2132fa1d170c1f5594cb74ffa8e924092 (2.9)"
          }
        ]
      }
    },
    "cosmic": {
      "openvswitch": {
        "name": "openvswitch",
        "status": "not-affected",
        "note": "2.10.0-0ubuntu2",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/9a0ac025de9303334688ff08f01fc08604d2f624 (master)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/638d406e3b647359f3d82189d7a6ee56b4a54928 (branch-2.8)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/0befd1f3745055c32940f5faf9559be6a14395e6 (branch-2.7)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/24bf63b2132fa1d170c1f5594cb74ffa8e924092 (2.9)"
          }
        ]
      }
    },
    "devel": {
      "openvswitch": {
        "name": "openvswitch",
        "status": "not-affected",
        "note": "2.10.0-0ubuntu2",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/9a0ac025de9303334688ff08f01fc08604d2f624 (master)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/638d406e3b647359f3d82189d7a6ee56b4a54928 (branch-2.8)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/0befd1f3745055c32940f5faf9559be6a14395e6 (branch-2.7)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/24bf63b2132fa1d170c1f5594cb74ffa8e924092 (2.9)"
          }
        ]
      }
    },
    "esm-infra/bionic": {
      "openvswitch": {
        "name": "openvswitch",
        "status": "released",
        "note": "2.9.2-0ubuntu0.18.04.3",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/9a0ac025de9303334688ff08f01fc08604d2f624 (master)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/638d406e3b647359f3d82189d7a6ee56b4a54928 (branch-2.8)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/0befd1f3745055c32940f5faf9559be6a14395e6 (branch-2.7)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/24bf63b2132fa1d170c1f5594cb74ffa8e924092 (2.9)"
          }
        ]
      }
    },
    "esm-infra/xenial": {
      "openvswitch": {
        "name": "openvswitch",
        "status": "not-affected",
        "note": "code not present",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/9a0ac025de9303334688ff08f01fc08604d2f624 (master)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/638d406e3b647359f3d82189d7a6ee56b4a54928 (branch-2.8)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/0befd1f3745055c32940f5faf9559be6a14395e6 (branch-2.7)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/24bf63b2132fa1d170c1f5594cb74ffa8e924092 (2.9)"
          }
        ]
      }
    },
    "precise/esm": {
      "openvswitch": {
        "name": "openvswitch",
        "status": "DNE",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/9a0ac025de9303334688ff08f01fc08604d2f624 (master)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/638d406e3b647359f3d82189d7a6ee56b4a54928 (branch-2.8)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/0befd1f3745055c32940f5faf9559be6a14395e6 (branch-2.7)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/24bf63b2132fa1d170c1f5594cb74ffa8e924092 (2.9)"
          }
        ]
      }
    },
    "trusty": {
      "openvswitch": {
        "name": "openvswitch",
        "status": "not-affected",
        "note": "code not present",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/9a0ac025de9303334688ff08f01fc08604d2f624 (master)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/638d406e3b647359f3d82189d7a6ee56b4a54928 (branch-2.8)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/0befd1f3745055c32940f5faf9559be6a14395e6 (branch-2.7)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/24bf63b2132fa1d170c1f5594cb74ffa8e924092 (2.9)"
          }
        ]
      }
    },
    "trusty/esm": {
      "openvswitch": {
        "name": "openvswitch",
        "status": "DNE",
        "note": "trusty was not-affected [code not present]",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/9a0ac025de9303334688ff08f01fc08604d2f624 (master)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/638d406e3b647359f3d82189d7a6ee56b4a54928 (branch-2.8)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/0befd1f3745055c32940f5faf9559be6a14395e6 (branch-2.7)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/24bf63b2132fa1d170c1f5594cb74ffa8e924092 (2.9)"
          }
        ]
      }
    },
    "upstream": {
      "openvswitch": {
        "name": "openvswitch",
        "status": "needs-triage",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/9a0ac025de9303334688ff08f01fc08604d2f624 (master)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/638d406e3b647359f3d82189d7a6ee56b4a54928 (branch-2.8)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/0befd1f3745055c32940f5faf9559be6a14395e6 (branch-2.7)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/24bf63b2132fa1d170c1f5594cb74ffa8e924092 (2.9)"
          }
        ]
      }
    },
    "xenial": {
      "openvswitch": {
        "name": "openvswitch",
        "status": "not-affected",
        "note": "code not present",
        "patches": [
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/9a0ac025de9303334688ff08f01fc08604d2f624 (master)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/638d406e3b647359f3d82189d7a6ee56b4a54928 (branch-2.8)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/0befd1f3745055c32940f5faf9559be6a14395e6 (branch-2.7)"
          },
          {
            "source": "upstream",
            "text": "https://github.com/openvswitch/ovs/commit/24bf63b2132fa1d170c1f5594cb74ffa8e924092 (2.9)"
          }
        ]
      }
    }
  }
}
