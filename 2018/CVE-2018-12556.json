{
	"candidate": "CVE-2018-12556",
	"description": "The signature verification routine in install.sh in yarnpkg/website through 2018-06-05 only verifies that the yarn release is signed by any (arbitrary) key in the local keyring of the user, and does not pin the signature to the yarn release key, which allows remote attackers to sign tampered yarn release packages with their own key.",
	"notes": {
		"curl url ": "bash - auto-updated mechanism inside the program. It looks like it tries to determine if it was installed via deb and if so, runs: sudo apt-get update && sudo apt-get install yarn",
		"seth-arnold": "It appears this is about the install.sh that is run via a So it's possible the unsafe mechanism isn't used in our packages. It's also possible this is seriously unsafe."
	},
	"priority": "medium",
	"cvss": {
		"nvd": " CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N [5.9 MEDIUM]"
	},
	"references": [
		"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12556",
		"http://packetstormsecurity.com/files/152703/Johnny-You-Are-Fired.html",
		"http://seclists.org/fulldisclosure/2019/Apr/38",
		"https://github.com/RUB-NDS/Johnny-You-Are-Fired",
		"https://github.com/RUB-NDS/Johnny-You-Are-Fired/blob/master/paper/johnny-fired.pdf",
		"https://github.com/yarnpkg/website/commits/master",
		"https://www.openwall.com/lists/oss-security/2019/04/30/4",
		"https://neopg.io/blog/yarn-signature-bypass/"
	],
	"discovered_by": "Marcus Brinkmann",
	"public_date": "2019-05-16 17:29:00 UTC",
	"packages": {
		"bionic": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "DNE"
			}
		},
		"cosmic": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "DNE"
			}
		},
		"devel": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "needs-triage"
			}
		},
		"disco": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "ignored",
				"note": "end of life"
			}
		},
		"eoan": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "ignored",
				"note": "end of life"
			}
		},
		"esm-apps/focal": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "needs-triage"
			}
		},
		"esm-apps/jammy": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "needs-triage"
			}
		},
		"focal": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "needs-triage"
			}
		},
		"groovy": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "ignored",
				"note": "end of life"
			}
		},
		"hirsute": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "ignored",
				"note": "end of life"
			}
		},
		"impish": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "ignored",
				"note": "end of life"
			}
		},
		"jammy": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "needs-triage"
			}
		},
		"kinetic": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "ignored",
				"note": "end of life, was needs-triage"
			}
		},
		"lunar": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "needs-triage"
			}
		},
		"mantic": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "needs-triage"
			}
		},
		"precise/esm": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "DNE"
			}
		},
		"trusty": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "ignored",
				"note": "end of standard support"
			}
		},
		"trusty/esm": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "DNE"
			}
		},
		"upstream": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "needs-triage"
			}
		},
		"xenial": {
			"node-yarnpkg": {
				"name": "node-yarnpkg",
				"status": "DNE"
			}
		}
	}
}
